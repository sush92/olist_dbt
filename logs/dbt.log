[0m14:55:00.428354 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106fcff10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108fa5410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108fa5990>]}


============================== 14:55:00.430840 | 10d58e0a-1fd8-4c23-80f6-5f8442c8b84c ==============================
[0m14:55:00.430840 [info ] [MainThread]: Running with dbt=1.9.0-b3
[0m14:55:00.431142 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/sushmitha/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt init olist_dbt_project', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:55:00.439014 [warn ] [MainThread]: [ConfigFolderDirectory]: Unable to parse logging event dictionary. Failed to parse dir field: expected string or bytes-like object, got 'PosixPath'.. Dictionary: {'dir': PosixPath('/Users/sushmitha/.dbt')}
[0m14:55:00.439296 [info ] [MainThread]: Creating dbt configuration folder at 
[0m14:55:00.440253 [debug] [MainThread]: Starter project path: /Users/sushmitha/Documents/projects/olist_dbt_project/envolist/lib/python3.11/site-packages/dbt/include/starter_project
[0m14:55:00.444562 [info ] [MainThread]: 
Your new dbt project "olist_dbt_project" was created!

For more information on how to configure the profiles.yml file,
please consult the dbt documentation here:

  https://docs.getdbt.com/docs/configure-your-profile

One more thing:

Need help? Don't hesitate to reach out to us via GitHub issues or on Slack:

  https://community.getdbt.com/

Happy modeling!

[0m14:55:00.444825 [info ] [MainThread]: Setting up your profile.
[0m14:55:45.041174 [error] [MainThread]: Encountered an error:
list index out of range
[0m14:55:45.046722 [error] [MainThread]: Traceback (most recent call last):
  File "/Users/sushmitha/Documents/projects/olist_dbt_project/envolist/lib/python3.11/site-packages/dbt/cli/requires.py", line 153, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/sushmitha/Documents/projects/olist_dbt_project/envolist/lib/python3.11/site-packages/dbt/cli/requires.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/sushmitha/Documents/projects/olist_dbt_project/envolist/lib/python3.11/site-packages/dbt/cli/main.py", line 477, in init
    results = task.run()
              ^^^^^^^^^^
  File "/Users/sushmitha/Documents/projects/olist_dbt_project/envolist/lib/python3.11/site-packages/dbt/task/init.py", line 346, in run
    self.setup_profile(profile_name)
  File "/Users/sushmitha/Documents/projects/olist_dbt_project/envolist/lib/python3.11/site-packages/dbt/task/init.py", line 261, in setup_profile
    adapter = self.ask_for_adapter_choice()
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/sushmitha/Documents/projects/olist_dbt_project/envolist/lib/python3.11/site-packages/dbt/task/init.py", line 243, in ask_for_adapter_choice
    return available_adapters[numeric_choice - 1]
           ~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^
IndexError: list index out of range

[0m14:55:45.084789 [debug] [MainThread]: Resource report: {"command_name": "init", "command_wall_clock_time": 44.692245, "process_user_time": 0.698239, "process_kernel_time": 0.152455, "process_mem_max_rss": "95682560", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:55:45.085613 [debug] [MainThread]: Command `dbt init` failed at 14:55:45.085486 after 44.69 seconds
[0m14:55:45.086107 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108fa5b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108fb6390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d54390>]}
[0m14:55:45.086557 [debug] [MainThread]: Flushing usage events
[0m14:55:46.046182 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:55:14.127658 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a16d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a62c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a63150>]}


============================== 15:55:14.130484 | 5b566b9b-bfd5-4f6f-ad7f-6976ebc88a16 ==============================
[0m15:55:14.130484 [info ] [MainThread]: Running with dbt=1.9.0-b3
[0m15:55:14.130904 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/sushmitha/.dbt', 'log_path': 'logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m15:55:14.131267 [error] [MainThread]: Encountered an error:
Runtime Error
  No dbt_project.yml found at expected path /Users/sushmitha/Documents/projects/olist_dbt_project/dbt_project.yml
  Verify that each entry within packages.yml (and their transitive dependencies) contains a file named dbt_project.yml
  
[0m15:55:14.155219 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.05979, "process_user_time": 0.568706, "process_kernel_time": 0.102454, "process_mem_max_rss": "95485952", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m15:55:14.155881 [debug] [MainThread]: Command `dbt run` failed at 15:55:14.155805 after 0.06 seconds
[0m15:55:14.156156 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a62c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102bdff50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105df2310>]}
[0m15:55:14.156407 [debug] [MainThread]: Flushing usage events
[0m15:55:15.318749 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:58:05.789072 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b453d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106fade10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106fae3d0>]}


============================== 15:58:05.792496 | 2f09632f-9235-477a-b9b0-1eb1d6d26f2f ==============================
[0m15:58:05.792496 [info ] [MainThread]: Running with dbt=1.9.0-b3
[0m15:58:05.792814 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/sushmitha/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m15:58:05.793132 [error] [MainThread]: Encountered an error:
Runtime Error
  No dbt_project.yml found at expected path /Users/sushmitha/Documents/projects/olist_dbt_project/dbt_project.yml
  Verify that each entry within packages.yml (and their transitive dependencies) contains a file named dbt_project.yml
  
[0m15:58:05.794046 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.03673817, "process_user_time": 0.552133, "process_kernel_time": 0.121221, "process_mem_max_rss": "93552640", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m15:58:05.794339 [debug] [MainThread]: Command `dbt run` failed at 15:58:05.794286 after 0.04 seconds
[0m15:58:05.794533 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1030fff50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f82390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f82ad0>]}
[0m15:58:05.794714 [debug] [MainThread]: Flushing usage events
[0m15:58:06.753897 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:28:30.972476 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a8bc10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107aa6250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107aa6c10>]}


============================== 20:28:30.976708 | b749b7e6-f51e-4acc-b38f-d81064e295ff ==============================
[0m20:28:30.976708 [info ] [MainThread]: Running with dbt=1.9.0-b3
[0m20:28:30.977073 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'logs', 'profiles_dir': '/Users/sushmitha/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt test', 'send_anonymous_usage_stats': 'True'}
[0m20:28:30.977399 [error] [MainThread]: Encountered an error:
Runtime Error
  No dbt_project.yml found at expected path /Users/sushmitha/Documents/projects/olist_dbt_project/dbt_project.yml
  Verify that each entry within packages.yml (and their transitive dependencies) contains a file named dbt_project.yml
  
[0m20:28:30.978823 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 0.04559104, "process_user_time": 0.581769, "process_kernel_time": 0.140042, "process_mem_max_rss": "95043584", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m20:28:30.979142 [debug] [MainThread]: Command `dbt test` failed at 20:28:30.979084 after 0.05 seconds
[0m20:28:30.979348 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107aa6610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102247f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a912d0>]}
[0m20:28:30.979537 [debug] [MainThread]: Flushing usage events
[0m20:28:32.508727 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:28:48.333692 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106502810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062f1390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10674eb10>]}


============================== 20:28:48.336196 | 570ae7a8-deba-4817-9db4-76ad85a91362 ==============================
[0m20:28:48.336196 [info ] [MainThread]: Running with dbt=1.9.0-b3
[0m20:28:48.336523 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/sushmitha/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:28:48.336829 [error] [MainThread]: Encountered an error:
Runtime Error
  No dbt_project.yml found at expected path /Users/sushmitha/Documents/projects/olist_dbt_project/dbt_project.yml
  Verify that each entry within packages.yml (and their transitive dependencies) contains a file named dbt_project.yml
  
[0m20:28:48.337770 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 0.034395125, "process_user_time": 0.55396, "process_kernel_time": 0.100129, "process_mem_max_rss": "95109120", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m20:28:48.338105 [debug] [MainThread]: Command `dbt test` failed at 20:28:48.338049 after 0.03 seconds
[0m20:28:48.338313 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1028aff50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106733a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066e20d0>]}
[0m20:28:48.338500 [debug] [MainThread]: Flushing usage events
[0m20:28:49.668740 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:29:54.699508 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065f6650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10663d690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10663e050>]}


============================== 20:29:54.702133 | 26a26462-d6dd-4f22-b315-55a947cb0220 ==============================
[0m20:29:54.702133 [info ] [MainThread]: Running with dbt=1.9.0-b3
[0m20:29:54.702506 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/sushmitha/.dbt', 'log_path': 'logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt init olist_dbt_project', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m20:29:54.711151 [debug] [MainThread]: Starter project path: /Users/sushmitha/Documents/projects/olist_dbt_project/envolist/lib/python3.11/site-packages/dbt/include/starter_project
[0m20:29:54.714988 [info ] [MainThread]: 
Your new dbt project "olist_dbt_project" was created!

For more information on how to configure the profiles.yml file,
please consult the dbt documentation here:

  https://docs.getdbt.com/docs/configure-your-profile

One more thing:

Need help? Don't hesitate to reach out to us via GitHub issues or on Slack:

  https://community.getdbt.com/

Happy modeling!

[0m20:29:54.715191 [info ] [MainThread]: Setting up your profile.
[0m20:30:20.064558 [debug] [MainThread]: Resource report: {"command_name": "init", "command_success": true, "command_wall_clock_time": 25.402548, "process_user_time": 0.565921, "process_kernel_time": 0.128114, "process_mem_max_rss": "96043008", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m20:30:20.066246 [debug] [MainThread]: Command `dbt init` succeeded at 20:30:20.066044 after 25.40 seconds
[0m20:30:20.066955 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10663db90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10663d490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10278db50>]}
[0m20:30:20.067549 [debug] [MainThread]: Flushing usage events
[0m20:30:21.316890 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:30:43.628621 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102e8ab50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10492a150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10492ab10>]}


============================== 20:30:43.631082 | 0ea00905-747c-497f-9987-be8793e52b8b ==============================
[0m20:30:43.631082 [info ] [MainThread]: Running with dbt=1.9.0-b3
[0m20:30:43.631405 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/sushmitha/.dbt', 'log_path': 'logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt test', 'send_anonymous_usage_stats': 'True'}
[0m20:30:43.631712 [error] [MainThread]: Encountered an error:
Runtime Error
  No dbt_project.yml found at expected path /Users/sushmitha/Documents/projects/olist_dbt_project/dbt_project.yml
  Verify that each entry within packages.yml (and their transitive dependencies) contains a file named dbt_project.yml
  
[0m20:30:43.632491 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 0.033623666, "process_user_time": 0.549035, "process_kernel_time": 0.102184, "process_mem_max_rss": "95272960", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m20:30:43.632773 [debug] [MainThread]: Command `dbt test` failed at 20:30:43.632723 after 0.03 seconds
[0m20:30:43.632974 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100a8bf50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10492a3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100bccc90>]}
[0m20:30:43.633154 [debug] [MainThread]: Flushing usage events
[0m20:30:44.837544 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:32:23.873142 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049966d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049dd710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049de0d0>]}


============================== 20:32:23.876188 | 97c1d73b-d912-45b5-a0b3-35fe2ccd4180 ==============================
[0m20:32:23.876188 [info ] [MainThread]: Running with dbt=1.9.0-b3
[0m20:32:23.876503 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'logs', 'debug': 'False', 'profiles_dir': '/Users/sushmitha/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt init temp_olist_project', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m20:32:23.885373 [debug] [MainThread]: Starter project path: /Users/sushmitha/Documents/projects/olist_dbt_project/envolist/lib/python3.11/site-packages/dbt/include/starter_project
[0m20:32:23.889407 [info ] [MainThread]: 
Your new dbt project "temp_olist_project" was created!

For more information on how to configure the profiles.yml file,
please consult the dbt documentation here:

  https://docs.getdbt.com/docs/configure-your-profile

One more thing:

Need help? Don't hesitate to reach out to us via GitHub issues or on Slack:

  https://community.getdbt.com/

Happy modeling!

[0m20:32:23.889648 [info ] [MainThread]: Setting up your profile.
[0m20:34:18.652622 [info ] [MainThread]: Profile temp_olist_project written to /Users/sushmitha/.dbt/profiles.yml using target's profile_template.yml and your supplied values. Run 'dbt debug' to validate the connection.
[0m20:34:18.656401 [debug] [MainThread]: Resource report: {"command_name": "init", "command_success": true, "command_wall_clock_time": 114.80075, "process_user_time": 0.587715, "process_kernel_time": 0.114101, "process_mem_max_rss": "98074624", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m20:34:18.657392 [debug] [MainThread]: Command `dbt init` succeeded at 20:34:18.657225 after 114.80 seconds
[0m20:34:18.658004 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049dfa90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049dd490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100c70d90>]}
[0m20:34:18.658584 [debug] [MainThread]: Flushing usage events
[0m20:34:19.679724 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:34:45.442369 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062f2410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063e1590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106452b50>]}


============================== 20:34:45.445325 | 77f44700-817d-4e2e-9dcd-b0e398ee4586 ==============================
[0m20:34:45.445325 [info ] [MainThread]: Running with dbt=1.9.0-b3
[0m20:34:45.445652 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/sushmitha/.dbt', 'log_path': '/Users/sushmitha/Documents/projects/olist_dbt_project/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt test', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m20:34:45.539697 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '77f44700-817d-4e2e-9dcd-b0e398ee4586', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105059a90>]}
[0m20:34:45.563336 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '77f44700-817d-4e2e-9dcd-b0e398ee4586', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1044a9350>]}
[0m20:34:45.564061 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m20:34:45.601947 [debug] [MainThread]: checksum: 5f4fde221ca8627174a0341efc73099aaec05b8546408ceed6f59b1ec0755115, vars: {}, profile: , target: , version: 1.9.0b3
[0m20:34:45.602465 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m20:34:45.602690 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '77f44700-817d-4e2e-9dcd-b0e398ee4586', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069fb850>]}
[0m20:34:46.114376 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.temp_olist_project.customer_metrics' (models/transformations/customer_metrics.sql) depends on a node named 'stg_customers' which was not found
[0m20:34:46.116801 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 0.7070064, "process_user_time": 1.144602, "process_kernel_time": 0.141975, "process_mem_max_rss": "111345664", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m20:34:46.117107 [debug] [MainThread]: Command `dbt test` failed at 20:34:46.117059 after 0.71 seconds
[0m20:34:46.117315 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1025abf50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072bd950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064525d0>]}
[0m20:34:46.117497 [debug] [MainThread]: Flushing usage events
[0m20:34:47.119186 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:36:19.192521 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104837cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048a9fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048aa910>]}


============================== 20:36:19.195246 | bde7c5da-f3d9-4fbf-b57d-7ed836dbfef1 ==============================
[0m20:36:19.195246 [info ] [MainThread]: Running with dbt=1.9.0-b3
[0m20:36:19.195584 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/sushmitha/.dbt', 'log_path': '/Users/sushmitha/Documents/projects/olist_dbt_project/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run --models staging', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:36:19.282232 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bde7c5da-f3d9-4fbf-b57d-7ed836dbfef1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104889250>]}
[0m20:36:19.305832 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bde7c5da-f3d9-4fbf-b57d-7ed836dbfef1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1028fd7d0>]}
[0m20:36:19.306480 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m20:36:19.315754 [debug] [MainThread]: checksum: 5f4fde221ca8627174a0341efc73099aaec05b8546408ceed6f59b1ec0755115, vars: {}, profile: , target: , version: 1.9.0b3
[0m20:36:19.316391 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m20:36:19.316640 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'bde7c5da-f3d9-4fbf-b57d-7ed836dbfef1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104daa950>]}
[0m20:36:19.863590 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.temp_olist_project.example
[0m20:36:19.868768 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bde7c5da-f3d9-4fbf-b57d-7ed836dbfef1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1055ebb50>]}
[0m20:36:19.951096 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bde7c5da-f3d9-4fbf-b57d-7ed836dbfef1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105485990>]}
[0m20:36:19.951401 [info ] [MainThread]: Found 3 models, 3 data tests, 11 sources, 428 macros
[0m20:36:19.951567 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bde7c5da-f3d9-4fbf-b57d-7ed836dbfef1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1054243d0>]}
[0m20:36:19.952331 [info ] [MainThread]: 
[0m20:36:19.952509 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:36:19.952639 [info ] [MainThread]: 
[0m20:36:19.952866 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:36:19.954543 [debug] [ThreadPool]: Acquiring new postgres connection 'list_olist_data'
[0m20:36:19.997460 [debug] [ThreadPool]: Using postgres connection "list_olist_data"
[0m20:36:19.997691 [debug] [ThreadPool]: On list_olist_data: /* {"app": "dbt", "dbt_version": "1.9.0b3", "profile_name": "temp_olist_project", "target_name": "dev", "connection_name": "list_olist_data"} */

    select distinct nspname from pg_namespace
  
[0m20:36:19.997825 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:36:20.087134 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.089 seconds
[0m20:36:20.092755 [debug] [ThreadPool]: On list_olist_data: Close
[0m20:36:20.093714 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_olist_data, now list_olist_data_olist_analytics)
[0m20:36:20.097784 [debug] [ThreadPool]: Using postgres connection "list_olist_data_olist_analytics"
[0m20:36:20.098022 [debug] [ThreadPool]: On list_olist_data_olist_analytics: BEGIN
[0m20:36:20.098208 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:36:20.105917 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m20:36:20.106125 [debug] [ThreadPool]: Using postgres connection "list_olist_data_olist_analytics"
[0m20:36:20.106356 [debug] [ThreadPool]: On list_olist_data_olist_analytics: /* {"app": "dbt", "dbt_version": "1.9.0b3", "profile_name": "temp_olist_project", "target_name": "dev", "connection_name": "list_olist_data_olist_analytics"} */
select
      'olist_data' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'olist_analytics'
    union all
    select
      'olist_data' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'olist_analytics'
    union all
    select
      'olist_data' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'olist_analytics'
  
[0m20:36:20.121564 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.015 seconds
[0m20:36:20.122584 [debug] [ThreadPool]: On list_olist_data_olist_analytics: ROLLBACK
[0m20:36:20.123188 [debug] [ThreadPool]: On list_olist_data_olist_analytics: Close
[0m20:36:20.127209 [debug] [MainThread]: Using postgres connection "master"
[0m20:36:20.127434 [debug] [MainThread]: On master: BEGIN
[0m20:36:20.127614 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:36:20.138319 [debug] [MainThread]: SQL status: BEGIN in 0.011 seconds
[0m20:36:20.138529 [debug] [MainThread]: Using postgres connection "master"
[0m20:36:20.138807 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0b3", "profile_name": "temp_olist_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:36:20.149617 [debug] [MainThread]: SQL status: SELECT 0 in 0.010 seconds
[0m20:36:20.150436 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bde7c5da-f3d9-4fbf-b57d-7ed836dbfef1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a5c2d0>]}
[0m20:36:20.150774 [debug] [MainThread]: On master: ROLLBACK
[0m20:36:20.151197 [debug] [MainThread]: Using postgres connection "master"
[0m20:36:20.151404 [debug] [MainThread]: On master: BEGIN
[0m20:36:20.151788 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m20:36:20.152220 [debug] [MainThread]: On master: COMMIT
[0m20:36:20.152534 [debug] [MainThread]: Using postgres connection "master"
[0m20:36:20.152738 [debug] [MainThread]: On master: COMMIT
[0m20:36:20.153369 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:36:20.153751 [debug] [MainThread]: On master: Close
[0m20:36:20.155712 [debug] [Thread-1 (]: Began running node model.temp_olist_project.stg_customers
[0m20:36:20.155987 [debug] [Thread-2 (]: Began running node model.temp_olist_project.stg_orders
[0m20:36:20.156313 [info ] [Thread-1 (]: 1 of 2 START sql view model olist_analytics.stg_customers ...................... [RUN]
[0m20:36:20.156646 [info ] [Thread-2 (]: 2 of 2 START sql view model olist_analytics.stg_orders ......................... [RUN]
[0m20:36:20.156976 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_olist_data_olist_analytics, now model.temp_olist_project.stg_customers)
[0m20:36:20.157311 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.temp_olist_project.stg_orders'
[0m20:36:20.157636 [debug] [Thread-1 (]: Began compiling node model.temp_olist_project.stg_customers
[0m20:36:20.157846 [debug] [Thread-2 (]: Began compiling node model.temp_olist_project.stg_orders
[0m20:36:20.163024 [debug] [Thread-1 (]: Writing injected SQL for node "model.temp_olist_project.stg_customers"
[0m20:36:20.165021 [debug] [Thread-2 (]: Writing injected SQL for node "model.temp_olist_project.stg_orders"
[0m20:36:20.165943 [debug] [Thread-1 (]: Began executing node model.temp_olist_project.stg_customers
[0m20:36:20.166196 [debug] [Thread-2 (]: Began executing node model.temp_olist_project.stg_orders
[0m20:36:20.186335 [debug] [Thread-1 (]: Writing runtime sql for node "model.temp_olist_project.stg_customers"
[0m20:36:20.188440 [debug] [Thread-2 (]: Writing runtime sql for node "model.temp_olist_project.stg_orders"
[0m20:36:20.189128 [debug] [Thread-2 (]: Using postgres connection "model.temp_olist_project.stg_orders"
[0m20:36:20.189362 [debug] [Thread-1 (]: Using postgres connection "model.temp_olist_project.stg_customers"
[0m20:36:20.189528 [debug] [Thread-2 (]: On model.temp_olist_project.stg_orders: BEGIN
[0m20:36:20.189701 [debug] [Thread-1 (]: On model.temp_olist_project.stg_customers: BEGIN
[0m20:36:20.189858 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m20:36:20.190005 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:36:20.198714 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m20:36:20.198985 [debug] [Thread-1 (]: Using postgres connection "model.temp_olist_project.stg_customers"
[0m20:36:20.199179 [debug] [Thread-1 (]: On model.temp_olist_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.0b3", "profile_name": "temp_olist_project", "target_name": "dev", "node_id": "model.temp_olist_project.stg_customers"} */

  create view "olist_data"."olist_analytics"."stg_customers__dbt_tmp"
    
    
  as (
    -- models/staging/stg_customers.sql
WITH raw_customers AS (
    SELECT * FROM "olist_data"."olist_analytics"."olist_customers_dataset"
)
SELECT
    customer_id,
    customer_unique_id,
    customer_zip_code_prefix,
    customer_city,
    customer_state
FROM raw_customers;
  );
[0m20:36:20.200536 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 17: FROM raw_customers;
                           ^

[0m20:36:20.200746 [debug] [Thread-1 (]: On model.temp_olist_project.stg_customers: ROLLBACK
[0m20:36:20.201259 [debug] [Thread-1 (]: On model.temp_olist_project.stg_customers: Close
[0m20:36:20.205987 [debug] [Thread-1 (]: Database Error in model stg_customers (models/staging/stg_customers.sql)
  syntax error at or near ";"
  LINE 17: FROM raw_customers;
                             ^
  compiled code at target/run/temp_olist_project/models/staging/stg_customers.sql
[0m20:36:20.207055 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bde7c5da-f3d9-4fbf-b57d-7ed836dbfef1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059b7390>]}
[0m20:36:20.207424 [error] [Thread-1 (]: 1 of 2 ERROR creating sql view model olist_analytics.stg_customers ............. [[31mERROR[0m in 0.05s]
[0m20:36:20.207735 [debug] [Thread-1 (]: Finished running node model.temp_olist_project.stg_customers
[0m20:36:20.207999 [debug] [Thread-7 (]: Marking all children of 'model.temp_olist_project.stg_customers' to be skipped because of status 'error'.  Reason: Database Error in model stg_customers (models/staging/stg_customers.sql)
  syntax error at or near ";"
  LINE 17: FROM raw_customers;
                             ^
  compiled code at target/run/temp_olist_project/models/staging/stg_customers.sql.
[0m20:36:20.209457 [debug] [Thread-2 (]: SQL status: BEGIN in 0.020 seconds
[0m20:36:20.209643 [debug] [Thread-2 (]: Using postgres connection "model.temp_olist_project.stg_orders"
[0m20:36:20.209832 [debug] [Thread-2 (]: On model.temp_olist_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.0b3", "profile_name": "temp_olist_project", "target_name": "dev", "node_id": "model.temp_olist_project.stg_orders"} */

  create view "olist_data"."olist_analytics"."stg_orders__dbt_tmp"
    
    
  as (
    WITH raw_orders AS (
    SELECT * FROM "olist_data"."olist_analytics"."olist_orders_dataset"
)
SELECT
    order_id,
    customer_id,
    order_purchase_timestamp,
    order_delivered_customer_date,
    DATE_PART('day', order_estimated_delivery_date - order_delivered_customer_date) AS delivery_delay
FROM raw_orders
WHERE order_status = 'delivered';
  );
[0m20:36:20.210424 [debug] [Thread-2 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 17: WHERE order_status = 'delivered';
                                         ^

[0m20:36:20.210594 [debug] [Thread-2 (]: On model.temp_olist_project.stg_orders: ROLLBACK
[0m20:36:20.210899 [debug] [Thread-2 (]: On model.temp_olist_project.stg_orders: Close
[0m20:36:20.212256 [debug] [Thread-2 (]: Database Error in model stg_orders (models/staging/stg_orders.sql)
  syntax error at or near ";"
  LINE 17: WHERE order_status = 'delivered';
                                           ^
  compiled code at target/run/temp_olist_project/models/staging/stg_orders.sql
[0m20:36:20.212481 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bde7c5da-f3d9-4fbf-b57d-7ed836dbfef1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a57890>]}
[0m20:36:20.212768 [error] [Thread-2 (]: 2 of 2 ERROR creating sql view model olist_analytics.stg_orders ................ [[31mERROR[0m in 0.06s]
[0m20:36:20.213029 [debug] [Thread-2 (]: Finished running node model.temp_olist_project.stg_orders
[0m20:36:20.213263 [debug] [Thread-7 (]: Marking all children of 'model.temp_olist_project.stg_orders' to be skipped because of status 'error'.  Reason: Database Error in model stg_orders (models/staging/stg_orders.sql)
  syntax error at or near ";"
  LINE 17: WHERE order_status = 'delivered';
                                           ^
  compiled code at target/run/temp_olist_project/models/staging/stg_orders.sql.
[0m20:36:20.213908 [debug] [MainThread]: Using postgres connection "master"
[0m20:36:20.214072 [debug] [MainThread]: On master: BEGIN
[0m20:36:20.214209 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:36:20.223521 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m20:36:20.223812 [debug] [MainThread]: On master: COMMIT
[0m20:36:20.223954 [debug] [MainThread]: Using postgres connection "master"
[0m20:36:20.224084 [debug] [MainThread]: On master: COMMIT
[0m20:36:20.224334 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:36:20.224484 [debug] [MainThread]: On master: Close
[0m20:36:20.224725 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:36:20.224852 [debug] [MainThread]: Connection 'model.temp_olist_project.stg_customers' was properly closed.
[0m20:36:20.224968 [debug] [MainThread]: Connection 'model.temp_olist_project.stg_orders' was properly closed.
[0m20:36:20.225142 [info ] [MainThread]: 
[0m20:36:20.225296 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 0.27 seconds (0.27s).
[0m20:36:20.225704 [debug] [MainThread]: Command end result
[0m20:36:20.239986 [info ] [MainThread]: 
[0m20:36:20.240252 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successs, and 0 warnings:[0m
[0m20:36:20.240415 [info ] [MainThread]: 
[0m20:36:20.240600 [error] [MainThread]:   Database Error in model stg_customers (models/staging/stg_customers.sql)
  syntax error at or near ";"
  LINE 17: FROM raw_customers;
                             ^
  compiled code at target/run/temp_olist_project/models/staging/stg_customers.sql
[0m20:36:20.240760 [info ] [MainThread]: 
[0m20:36:20.240921 [error] [MainThread]:   Database Error in model stg_orders (models/staging/stg_orders.sql)
  syntax error at or near ";"
  LINE 17: WHERE order_status = 'delivered';
                                           ^
  compiled code at target/run/temp_olist_project/models/staging/stg_orders.sql
[0m20:36:20.241054 [info ] [MainThread]: 
[0m20:36:20.241196 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=2 SKIP=0 TOTAL=2
[0m20:36:20.242511 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.0824229, "process_user_time": 1.354313, "process_kernel_time": 0.19195, "process_mem_max_rss": "127107072", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m20:36:20.242858 [debug] [MainThread]: Command `dbt run` failed at 20:36:20.242809 after 1.08 seconds
[0m20:36:20.243082 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048be9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1009fdc90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10482b910>]}
[0m20:36:20.243287 [debug] [MainThread]: Flushing usage events
[0m20:36:21.181104 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:38:16.435952 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111a33f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111a3d590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111aae450>]}


============================== 20:38:16.438675 | d42b6451-996b-4a4b-969b-f08e8efec236 ==============================
[0m20:38:16.438675 [info ] [MainThread]: Running with dbt=1.9.0-b3
[0m20:38:16.439005 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/sushmitha/Documents/projects/olist_dbt_project/logs', 'version_check': 'True', 'profiles_dir': '/Users/sushmitha/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m20:38:16.520749 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd42b6451-996b-4a4b-969b-f08e8efec236', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111a3d090>]}
[0m20:38:16.543801 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd42b6451-996b-4a4b-969b-f08e8efec236', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068759d0>]}
[0m20:38:16.544281 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m20:38:16.553898 [debug] [MainThread]: checksum: 5f4fde221ca8627174a0341efc73099aaec05b8546408ceed6f59b1ec0755115, vars: {}, profile: , target: , version: 1.9.0b3
[0m20:38:16.617093 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 3 files changed.
[0m20:38:16.617465 [debug] [MainThread]: Partial parsing: updated file: temp_olist_project://models/staging/stg_orders.sql
[0m20:38:16.617656 [debug] [MainThread]: Partial parsing: updated file: temp_olist_project://models/transformations/customer_metrics.sql
[0m20:38:16.617825 [debug] [MainThread]: Partial parsing: updated file: temp_olist_project://models/staging/stg_customers.sql
[0m20:38:16.792772 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.temp_olist_project.example
[0m20:38:16.798586 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd42b6451-996b-4a4b-969b-f08e8efec236', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112901510>]}
[0m20:38:16.848698 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd42b6451-996b-4a4b-969b-f08e8efec236', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112c36710>]}
[0m20:38:16.849010 [info ] [MainThread]: Found 3 models, 3 data tests, 11 sources, 428 macros
[0m20:38:16.849183 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd42b6451-996b-4a4b-969b-f08e8efec236', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11285c450>]}
[0m20:38:16.850080 [info ] [MainThread]: 
[0m20:38:16.850255 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:38:16.850388 [info ] [MainThread]: 
[0m20:38:16.850627 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:38:16.852390 [debug] [ThreadPool]: Acquiring new postgres connection 'list_olist_data'
[0m20:38:16.880320 [debug] [ThreadPool]: Using postgres connection "list_olist_data"
[0m20:38:16.880541 [debug] [ThreadPool]: On list_olist_data: /* {"app": "dbt", "dbt_version": "1.9.0b3", "profile_name": "temp_olist_project", "target_name": "dev", "connection_name": "list_olist_data"} */

    select distinct nspname from pg_namespace
  
[0m20:38:16.880678 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:38:16.906884 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.026 seconds
[0m20:38:16.907657 [debug] [ThreadPool]: On list_olist_data: Close
[0m20:38:16.908256 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_olist_data, now list_olist_data_olist_analytics)
[0m20:38:16.911154 [debug] [ThreadPool]: Using postgres connection "list_olist_data_olist_analytics"
[0m20:38:16.911321 [debug] [ThreadPool]: On list_olist_data_olist_analytics: BEGIN
[0m20:38:16.911448 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:38:16.919491 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m20:38:16.919712 [debug] [ThreadPool]: Using postgres connection "list_olist_data_olist_analytics"
[0m20:38:16.919874 [debug] [ThreadPool]: On list_olist_data_olist_analytics: /* {"app": "dbt", "dbt_version": "1.9.0b3", "profile_name": "temp_olist_project", "target_name": "dev", "connection_name": "list_olist_data_olist_analytics"} */
select
      'olist_data' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'olist_analytics'
    union all
    select
      'olist_data' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'olist_analytics'
    union all
    select
      'olist_data' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'olist_analytics'
  
[0m20:38:16.923224 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.003 seconds
[0m20:38:16.923942 [debug] [ThreadPool]: On list_olist_data_olist_analytics: ROLLBACK
[0m20:38:16.924299 [debug] [ThreadPool]: On list_olist_data_olist_analytics: Close
[0m20:38:16.927361 [debug] [MainThread]: Using postgres connection "master"
[0m20:38:16.927535 [debug] [MainThread]: On master: BEGIN
[0m20:38:16.927670 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:38:16.936218 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m20:38:16.936415 [debug] [MainThread]: Using postgres connection "master"
[0m20:38:16.936650 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0b3", "profile_name": "temp_olist_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:38:16.945618 [debug] [MainThread]: SQL status: SELECT 0 in 0.009 seconds
[0m20:38:16.946253 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd42b6451-996b-4a4b-969b-f08e8efec236', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1129c94d0>]}
[0m20:38:16.946501 [debug] [MainThread]: On master: ROLLBACK
[0m20:38:16.946778 [debug] [MainThread]: Using postgres connection "master"
[0m20:38:16.946922 [debug] [MainThread]: On master: BEGIN
[0m20:38:16.947278 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m20:38:16.947428 [debug] [MainThread]: On master: COMMIT
[0m20:38:16.947568 [debug] [MainThread]: Using postgres connection "master"
[0m20:38:16.947699 [debug] [MainThread]: On master: COMMIT
[0m20:38:16.947940 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:38:16.948100 [debug] [MainThread]: On master: Close
[0m20:38:16.949437 [debug] [Thread-1 (]: Began running node model.temp_olist_project.stg_customers
[0m20:38:16.949657 [debug] [Thread-2 (]: Began running node model.temp_olist_project.stg_orders
[0m20:38:16.949914 [info ] [Thread-1 (]: 1 of 3 START sql view model olist_analytics.stg_customers ...................... [RUN]
[0m20:38:16.950179 [info ] [Thread-2 (]: 2 of 3 START sql view model olist_analytics.stg_orders ......................... [RUN]
[0m20:38:16.950557 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_olist_data_olist_analytics, now model.temp_olist_project.stg_customers)
[0m20:38:16.950802 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.temp_olist_project.stg_orders'
[0m20:38:16.950988 [debug] [Thread-1 (]: Began compiling node model.temp_olist_project.stg_customers
[0m20:38:16.951160 [debug] [Thread-2 (]: Began compiling node model.temp_olist_project.stg_orders
[0m20:38:16.955282 [debug] [Thread-1 (]: Writing injected SQL for node "model.temp_olist_project.stg_customers"
[0m20:38:16.956731 [debug] [Thread-2 (]: Writing injected SQL for node "model.temp_olist_project.stg_orders"
[0m20:38:16.957184 [debug] [Thread-1 (]: Began executing node model.temp_olist_project.stg_customers
[0m20:38:16.957359 [debug] [Thread-2 (]: Began executing node model.temp_olist_project.stg_orders
[0m20:38:16.975153 [debug] [Thread-1 (]: Writing runtime sql for node "model.temp_olist_project.stg_customers"
[0m20:38:16.977257 [debug] [Thread-2 (]: Writing runtime sql for node "model.temp_olist_project.stg_orders"
[0m20:38:16.977732 [debug] [Thread-1 (]: Using postgres connection "model.temp_olist_project.stg_customers"
[0m20:38:16.977921 [debug] [Thread-2 (]: Using postgres connection "model.temp_olist_project.stg_orders"
[0m20:38:16.978107 [debug] [Thread-1 (]: On model.temp_olist_project.stg_customers: BEGIN
[0m20:38:16.978267 [debug] [Thread-2 (]: On model.temp_olist_project.stg_orders: BEGIN
[0m20:38:16.978415 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:38:16.978556 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m20:38:16.985493 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m20:38:16.985665 [debug] [Thread-2 (]: SQL status: BEGIN in 0.007 seconds
[0m20:38:16.985840 [debug] [Thread-1 (]: Using postgres connection "model.temp_olist_project.stg_customers"
[0m20:38:16.986002 [debug] [Thread-2 (]: Using postgres connection "model.temp_olist_project.stg_orders"
[0m20:38:16.986179 [debug] [Thread-1 (]: On model.temp_olist_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.0b3", "profile_name": "temp_olist_project", "target_name": "dev", "node_id": "model.temp_olist_project.stg_customers"} */

  create view "olist_data"."olist_analytics"."stg_customers__dbt_tmp"
    
    
  as (
    -- models/staging/stg_customers.sql
WITH raw_customers AS (
    SELECT * FROM "olist_data"."olist_analytics"."olist_customers_dataset"
)
SELECT
    customer_id,
    customer_unique_id,
    customer_zip_code_prefix,
    customer_city,
    customer_state
FROM raw_customers
  );
[0m20:38:16.986371 [debug] [Thread-2 (]: On model.temp_olist_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.0b3", "profile_name": "temp_olist_project", "target_name": "dev", "node_id": "model.temp_olist_project.stg_orders"} */

  create view "olist_data"."olist_analytics"."stg_orders__dbt_tmp"
    
    
  as (
    -- models/staging/stg_orders.sql
WITH raw_orders AS (
    SELECT * FROM "olist_data"."olist_analytics"."olist_orders_dataset"
)
SELECT
    order_id,
    customer_id,
    order_purchase_timestamp,
    order_delivered_customer_date,
    DATE_PART('day', order_estimated_delivery_date - order_delivered_customer_date) AS delivery_delay
FROM raw_orders
WHERE order_status = 'delivered'
  );
[0m20:38:16.989322 [debug] [Thread-2 (]: Postgres adapter: Postgres error: operator does not exist: text - text
LINE 16: ...   DATE_PART('day', order_estimated_delivery_date - order_de...
                                                              ^
HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.

[0m20:38:16.989540 [debug] [Thread-2 (]: On model.temp_olist_project.stg_orders: ROLLBACK
[0m20:38:16.989896 [debug] [Thread-2 (]: On model.temp_olist_project.stg_orders: Close
[0m20:38:16.994402 [debug] [Thread-2 (]: Database Error in model stg_orders (models/staging/stg_orders.sql)
  operator does not exist: text - text
  LINE 16: ...   DATE_PART('day', order_estimated_delivery_date - order_de...
                                                                ^
  HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target/run/temp_olist_project/models/staging/stg_orders.sql
[0m20:38:16.995438 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd42b6451-996b-4a4b-969b-f08e8efec236', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112fb9cd0>]}
[0m20:38:16.995807 [error] [Thread-2 (]: 2 of 3 ERROR creating sql view model olist_analytics.stg_orders ................ [[31mERROR[0m in 0.04s]
[0m20:38:16.996088 [debug] [Thread-2 (]: Finished running node model.temp_olist_project.stg_orders
[0m20:38:16.996367 [debug] [Thread-7 (]: Marking all children of 'model.temp_olist_project.stg_orders' to be skipped because of status 'error'.  Reason: Database Error in model stg_orders (models/staging/stg_orders.sql)
  operator does not exist: text - text
  LINE 16: ...   DATE_PART('day', order_estimated_delivery_date - order_de...
                                                                ^
  HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target/run/temp_olist_project/models/staging/stg_orders.sql.
[0m20:38:17.000788 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.014 seconds
[0m20:38:17.004357 [debug] [Thread-1 (]: Using postgres connection "model.temp_olist_project.stg_customers"
[0m20:38:17.004647 [debug] [Thread-1 (]: On model.temp_olist_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.0b3", "profile_name": "temp_olist_project", "target_name": "dev", "node_id": "model.temp_olist_project.stg_customers"} */
alter table "olist_data"."olist_analytics"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m20:38:17.005863 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:38:17.013228 [debug] [Thread-1 (]: On model.temp_olist_project.stg_customers: COMMIT
[0m20:38:17.013526 [debug] [Thread-1 (]: Using postgres connection "model.temp_olist_project.stg_customers"
[0m20:38:17.013685 [debug] [Thread-1 (]: On model.temp_olist_project.stg_customers: COMMIT
[0m20:38:17.015202 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m20:38:17.018284 [debug] [Thread-1 (]: Applying DROP to: "olist_data"."olist_analytics"."stg_customers__dbt_backup"
[0m20:38:17.020685 [debug] [Thread-1 (]: Using postgres connection "model.temp_olist_project.stg_customers"
[0m20:38:17.020968 [debug] [Thread-1 (]: On model.temp_olist_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.0b3", "profile_name": "temp_olist_project", "target_name": "dev", "node_id": "model.temp_olist_project.stg_customers"} */
drop view if exists "olist_data"."olist_analytics"."stg_customers__dbt_backup" cascade
[0m20:38:17.022169 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m20:38:17.023564 [debug] [Thread-1 (]: On model.temp_olist_project.stg_customers: Close
[0m20:38:17.023935 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd42b6451-996b-4a4b-969b-f08e8efec236', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112fa8090>]}
[0m20:38:17.024253 [info ] [Thread-1 (]: 1 of 3 OK created sql view model olist_analytics.stg_customers ................. [[32mCREATE VIEW[0m in 0.07s]
[0m20:38:17.024517 [debug] [Thread-1 (]: Finished running node model.temp_olist_project.stg_customers
[0m20:38:17.024890 [debug] [Thread-4 (]: Began running node model.temp_olist_project.customer_metrics
[0m20:38:17.025100 [info ] [Thread-4 (]: 3 of 3 START sql view model olist_analytics.customer_metrics ................... [RUN]
[0m20:38:17.025395 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.temp_olist_project.customer_metrics'
[0m20:38:17.025591 [debug] [Thread-4 (]: Began compiling node model.temp_olist_project.customer_metrics
[0m20:38:17.027105 [debug] [Thread-4 (]: Writing injected SQL for node "model.temp_olist_project.customer_metrics"
[0m20:38:17.027596 [debug] [Thread-4 (]: Began executing node model.temp_olist_project.customer_metrics
[0m20:38:17.029307 [debug] [Thread-4 (]: Writing runtime sql for node "model.temp_olist_project.customer_metrics"
[0m20:38:17.029659 [debug] [Thread-4 (]: Using postgres connection "model.temp_olist_project.customer_metrics"
[0m20:38:17.029809 [debug] [Thread-4 (]: On model.temp_olist_project.customer_metrics: BEGIN
[0m20:38:17.029945 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m20:38:17.036718 [debug] [Thread-4 (]: SQL status: BEGIN in 0.007 seconds
[0m20:38:17.036921 [debug] [Thread-4 (]: Using postgres connection "model.temp_olist_project.customer_metrics"
[0m20:38:17.037096 [debug] [Thread-4 (]: On model.temp_olist_project.customer_metrics: /* {"app": "dbt", "dbt_version": "1.9.0b3", "profile_name": "temp_olist_project", "target_name": "dev", "node_id": "model.temp_olist_project.customer_metrics"} */

  create view "olist_data"."olist_analytics"."customer_metrics__dbt_tmp"
    
    
  as (
    SELECT
    c.customer_id,
    c.customer_unique_id,
    c.customer_city,
    c.customer_state,
    co.total_orders,
    co.total_spent
FROM "olist_data"."olist_analytics"."stg_customers" c
LEFT JOIN customer_orders co ON c.customer_id = co.customer_id;
  );
[0m20:38:17.037492 [debug] [Thread-4 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 15: ...T JOIN customer_orders co ON c.customer_id = co.customer_id;
                                                                       ^

[0m20:38:17.037661 [debug] [Thread-4 (]: On model.temp_olist_project.customer_metrics: ROLLBACK
[0m20:38:17.037953 [debug] [Thread-4 (]: On model.temp_olist_project.customer_metrics: Close
[0m20:38:17.039292 [debug] [Thread-4 (]: Database Error in model customer_metrics (models/transformations/customer_metrics.sql)
  syntax error at or near ";"
  LINE 15: ...T JOIN customer_orders co ON c.customer_id = co.customer_id;
                                                                         ^
  compiled code at target/run/temp_olist_project/models/transformations/customer_metrics.sql
[0m20:38:17.039552 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd42b6451-996b-4a4b-969b-f08e8efec236', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113107650>]}
[0m20:38:17.039866 [error] [Thread-4 (]: 3 of 3 ERROR creating sql view model olist_analytics.customer_metrics .......... [[31mERROR[0m in 0.01s]
[0m20:38:17.040128 [debug] [Thread-4 (]: Finished running node model.temp_olist_project.customer_metrics
[0m20:38:17.040385 [debug] [Thread-7 (]: Marking all children of 'model.temp_olist_project.customer_metrics' to be skipped because of status 'error'.  Reason: Database Error in model customer_metrics (models/transformations/customer_metrics.sql)
  syntax error at or near ";"
  LINE 15: ...T JOIN customer_orders co ON c.customer_id = co.customer_id;
                                                                         ^
  compiled code at target/run/temp_olist_project/models/transformations/customer_metrics.sql.
[0m20:38:17.041117 [debug] [MainThread]: Using postgres connection "master"
[0m20:38:17.041273 [debug] [MainThread]: On master: BEGIN
[0m20:38:17.041397 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:38:17.048532 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m20:38:17.048765 [debug] [MainThread]: On master: COMMIT
[0m20:38:17.048901 [debug] [MainThread]: Using postgres connection "master"
[0m20:38:17.049036 [debug] [MainThread]: On master: COMMIT
[0m20:38:17.049248 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:38:17.049383 [debug] [MainThread]: On master: Close
[0m20:38:17.049622 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:38:17.049743 [debug] [MainThread]: Connection 'model.temp_olist_project.stg_customers' was properly closed.
[0m20:38:17.049855 [debug] [MainThread]: Connection 'model.temp_olist_project.stg_orders' was properly closed.
[0m20:38:17.049966 [debug] [MainThread]: Connection 'model.temp_olist_project.customer_metrics' was properly closed.
[0m20:38:17.050132 [info ] [MainThread]: 
[0m20:38:17.050283 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 0.20 seconds (0.20s).
[0m20:38:17.050713 [debug] [MainThread]: Command end result
[0m20:38:17.099833 [info ] [MainThread]: 
[0m20:38:17.100107 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successs, and 0 warnings:[0m
[0m20:38:17.100260 [info ] [MainThread]: 
[0m20:38:17.100436 [error] [MainThread]:   Database Error in model stg_orders (models/staging/stg_orders.sql)
  operator does not exist: text - text
  LINE 16: ...   DATE_PART('day', order_estimated_delivery_date - order_de...
                                                                ^
  HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target/run/temp_olist_project/models/staging/stg_orders.sql
[0m20:38:17.100581 [info ] [MainThread]: 
[0m20:38:17.100737 [error] [MainThread]:   Database Error in model customer_metrics (models/transformations/customer_metrics.sql)
  syntax error at or near ";"
  LINE 15: ...T JOIN customer_orders co ON c.customer_id = co.customer_id;
                                                                         ^
  compiled code at target/run/temp_olist_project/models/transformations/customer_metrics.sql
[0m20:38:17.100883 [info ] [MainThread]: 
[0m20:38:17.101035 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=2 SKIP=0 TOTAL=3
[0m20:38:17.102510 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.69891405, "process_user_time": 1.071086, "process_kernel_time": 0.173972, "process_mem_max_rss": "128090112", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m20:38:17.102784 [debug] [MainThread]: Command `dbt run` failed at 20:38:17.102740 after 0.70 seconds
[0m20:38:17.102978 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1131199d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113118e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1131185d0>]}
[0m20:38:17.103148 [debug] [MainThread]: Flushing usage events
[0m20:38:18.234799 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:38:53.119506 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104383e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1043f1ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1043f2490>]}


============================== 20:38:53.121662 | a5b8ca46-b167-4ad8-942d-ae0ff97d0e26 ==============================
[0m20:38:53.121662 [info ] [MainThread]: Running with dbt=1.9.0-b3
[0m20:38:53.121986 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/sushmitha/Documents/projects/olist_dbt_project/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/sushmitha/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:38:53.191883 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a5b8ca46-b167-4ad8-942d-ae0ff97d0e26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1043d4b90>]}
[0m20:38:53.214787 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a5b8ca46-b167-4ad8-942d-ae0ff97d0e26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102449010>]}
[0m20:38:53.215196 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m20:38:53.223182 [debug] [MainThread]: checksum: 5f4fde221ca8627174a0341efc73099aaec05b8546408ceed6f59b1ec0755115, vars: {}, profile: , target: , version: 1.9.0b3
[0m20:38:53.278670 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:38:53.279071 [debug] [MainThread]: Partial parsing: updated file: temp_olist_project://models/transformations/customer_metrics.sql
[0m20:38:53.380029 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.temp_olist_project.example
[0m20:38:53.385715 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a5b8ca46-b167-4ad8-942d-ae0ff97d0e26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104971890>]}
[0m20:38:53.431201 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a5b8ca46-b167-4ad8-942d-ae0ff97d0e26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105239990>]}
[0m20:38:53.431506 [info ] [MainThread]: Found 3 models, 3 data tests, 11 sources, 428 macros
[0m20:38:53.431676 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a5b8ca46-b167-4ad8-942d-ae0ff97d0e26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e9fe90>]}
[0m20:38:53.432564 [info ] [MainThread]: 
[0m20:38:53.432739 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:38:53.432869 [info ] [MainThread]: 
[0m20:38:53.433106 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:38:53.434862 [debug] [ThreadPool]: Acquiring new postgres connection 'list_olist_data'
[0m20:38:53.460092 [debug] [ThreadPool]: Using postgres connection "list_olist_data"
[0m20:38:53.460330 [debug] [ThreadPool]: On list_olist_data: /* {"app": "dbt", "dbt_version": "1.9.0b3", "profile_name": "temp_olist_project", "target_name": "dev", "connection_name": "list_olist_data"} */

    select distinct nspname from pg_namespace
  
[0m20:38:53.460469 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:38:53.476079 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.016 seconds
[0m20:38:53.476852 [debug] [ThreadPool]: On list_olist_data: Close
[0m20:38:53.477506 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_olist_data, now list_olist_data_olist_analytics)
[0m20:38:53.480519 [debug] [ThreadPool]: Using postgres connection "list_olist_data_olist_analytics"
[0m20:38:53.480733 [debug] [ThreadPool]: On list_olist_data_olist_analytics: BEGIN
[0m20:38:53.480865 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:38:53.490672 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m20:38:53.490903 [debug] [ThreadPool]: Using postgres connection "list_olist_data_olist_analytics"
[0m20:38:53.491055 [debug] [ThreadPool]: On list_olist_data_olist_analytics: /* {"app": "dbt", "dbt_version": "1.9.0b3", "profile_name": "temp_olist_project", "target_name": "dev", "connection_name": "list_olist_data_olist_analytics"} */
select
      'olist_data' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'olist_analytics'
    union all
    select
      'olist_data' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'olist_analytics'
    union all
    select
      'olist_data' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'olist_analytics'
  
[0m20:38:53.497626 [debug] [ThreadPool]: SQL status: SELECT 12 in 0.006 seconds
[0m20:38:53.498488 [debug] [ThreadPool]: On list_olist_data_olist_analytics: ROLLBACK
[0m20:38:53.498800 [debug] [ThreadPool]: On list_olist_data_olist_analytics: Close
[0m20:38:53.501715 [debug] [MainThread]: Using postgres connection "master"
[0m20:38:53.501893 [debug] [MainThread]: On master: BEGIN
[0m20:38:53.502016 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:38:53.510356 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m20:38:53.510496 [debug] [MainThread]: Using postgres connection "master"
[0m20:38:53.510681 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0b3", "profile_name": "temp_olist_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:38:53.522712 [debug] [MainThread]: SQL status: SELECT 1 in 0.012 seconds
[0m20:38:53.523443 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a5b8ca46-b167-4ad8-942d-ae0ff97d0e26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105227cd0>]}
[0m20:38:53.523671 [debug] [MainThread]: On master: ROLLBACK
[0m20:38:53.523963 [debug] [MainThread]: Using postgres connection "master"
[0m20:38:53.524100 [debug] [MainThread]: On master: BEGIN
[0m20:38:53.524473 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m20:38:53.524626 [debug] [MainThread]: On master: COMMIT
[0m20:38:53.524754 [debug] [MainThread]: Using postgres connection "master"
[0m20:38:53.524877 [debug] [MainThread]: On master: COMMIT
[0m20:38:53.525110 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:38:53.525247 [debug] [MainThread]: On master: Close
[0m20:38:53.526306 [debug] [Thread-1 (]: Began running node model.temp_olist_project.stg_customers
[0m20:38:53.526493 [debug] [Thread-2 (]: Began running node model.temp_olist_project.stg_orders
[0m20:38:53.526864 [info ] [Thread-1 (]: 1 of 3 START sql view model olist_analytics.stg_customers ...................... [RUN]
[0m20:38:53.527118 [info ] [Thread-2 (]: 2 of 3 START sql view model olist_analytics.stg_orders ......................... [RUN]
[0m20:38:53.527354 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_olist_data_olist_analytics, now model.temp_olist_project.stg_customers)
[0m20:38:53.527589 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.temp_olist_project.stg_orders'
[0m20:38:53.527765 [debug] [Thread-1 (]: Began compiling node model.temp_olist_project.stg_customers
[0m20:38:53.527931 [debug] [Thread-2 (]: Began compiling node model.temp_olist_project.stg_orders
[0m20:38:53.531960 [debug] [Thread-1 (]: Writing injected SQL for node "model.temp_olist_project.stg_customers"
[0m20:38:53.533401 [debug] [Thread-2 (]: Writing injected SQL for node "model.temp_olist_project.stg_orders"
[0m20:38:53.533894 [debug] [Thread-2 (]: Began executing node model.temp_olist_project.stg_orders
[0m20:38:53.534089 [debug] [Thread-1 (]: Began executing node model.temp_olist_project.stg_customers
[0m20:38:53.551284 [debug] [Thread-2 (]: Writing runtime sql for node "model.temp_olist_project.stg_orders"
[0m20:38:53.553269 [debug] [Thread-1 (]: Writing runtime sql for node "model.temp_olist_project.stg_customers"
[0m20:38:53.553711 [debug] [Thread-1 (]: Using postgres connection "model.temp_olist_project.stg_customers"
[0m20:38:53.553892 [debug] [Thread-2 (]: Using postgres connection "model.temp_olist_project.stg_orders"
[0m20:38:53.554066 [debug] [Thread-1 (]: On model.temp_olist_project.stg_customers: BEGIN
[0m20:38:53.554222 [debug] [Thread-2 (]: On model.temp_olist_project.stg_orders: BEGIN
[0m20:38:53.554370 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:38:53.554509 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m20:38:53.563161 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m20:38:53.563373 [debug] [Thread-2 (]: SQL status: BEGIN in 0.009 seconds
[0m20:38:53.563590 [debug] [Thread-1 (]: Using postgres connection "model.temp_olist_project.stg_customers"
[0m20:38:53.563769 [debug] [Thread-2 (]: Using postgres connection "model.temp_olist_project.stg_orders"
[0m20:38:53.563963 [debug] [Thread-1 (]: On model.temp_olist_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.0b3", "profile_name": "temp_olist_project", "target_name": "dev", "node_id": "model.temp_olist_project.stg_customers"} */

  create view "olist_data"."olist_analytics"."stg_customers__dbt_tmp"
    
    
  as (
    -- models/staging/stg_customers.sql
WITH raw_customers AS (
    SELECT * FROM "olist_data"."olist_analytics"."olist_customers_dataset"
)
SELECT
    customer_id,
    customer_unique_id,
    customer_zip_code_prefix,
    customer_city,
    customer_state
FROM raw_customers
  );
[0m20:38:53.564171 [debug] [Thread-2 (]: On model.temp_olist_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.0b3", "profile_name": "temp_olist_project", "target_name": "dev", "node_id": "model.temp_olist_project.stg_orders"} */

  create view "olist_data"."olist_analytics"."stg_orders__dbt_tmp"
    
    
  as (
    -- models/staging/stg_orders.sql
WITH raw_orders AS (
    SELECT * FROM "olist_data"."olist_analytics"."olist_orders_dataset"
)
SELECT
    order_id,
    customer_id,
    order_purchase_timestamp,
    order_delivered_customer_date,
    DATE_PART('day', order_estimated_delivery_date - order_delivered_customer_date) AS delivery_delay
FROM raw_orders
WHERE order_status = 'delivered'
  );
[0m20:38:53.565465 [debug] [Thread-2 (]: Postgres adapter: Postgres error: operator does not exist: text - text
LINE 16: ...   DATE_PART('day', order_estimated_delivery_date - order_de...
                                                              ^
HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.

[0m20:38:53.565647 [debug] [Thread-2 (]: On model.temp_olist_project.stg_orders: ROLLBACK
[0m20:38:53.566003 [debug] [Thread-2 (]: On model.temp_olist_project.stg_orders: Close
[0m20:38:53.568292 [debug] [Thread-2 (]: Database Error in model stg_orders (models/staging/stg_orders.sql)
  operator does not exist: text - text
  LINE 16: ...   DATE_PART('day', order_estimated_delivery_date - order_de...
                                                                ^
  HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target/run/temp_olist_project/models/staging/stg_orders.sql
[0m20:38:53.569075 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m20:38:53.572504 [debug] [Thread-1 (]: Using postgres connection "model.temp_olist_project.stg_customers"
[0m20:38:53.572732 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a5b8ca46-b167-4ad8-942d-ae0ff97d0e26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105698850>]}
[0m20:38:53.572908 [debug] [Thread-1 (]: On model.temp_olist_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.0b3", "profile_name": "temp_olist_project", "target_name": "dev", "node_id": "model.temp_olist_project.stg_customers"} */
alter table "olist_data"."olist_analytics"."stg_customers" rename to "stg_customers__dbt_backup"
[0m20:38:53.573248 [error] [Thread-2 (]: 2 of 3 ERROR creating sql view model olist_analytics.stg_orders ................ [[31mERROR[0m in 0.04s]
[0m20:38:53.573602 [debug] [Thread-2 (]: Finished running node model.temp_olist_project.stg_orders
[0m20:38:53.573860 [debug] [Thread-7 (]: Marking all children of 'model.temp_olist_project.stg_orders' to be skipped because of status 'error'.  Reason: Database Error in model stg_orders (models/staging/stg_orders.sql)
  operator does not exist: text - text
  LINE 16: ...   DATE_PART('day', order_estimated_delivery_date - order_de...
                                                                ^
  HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target/run/temp_olist_project/models/staging/stg_orders.sql.
[0m20:38:53.574046 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:38:53.576812 [debug] [Thread-1 (]: Using postgres connection "model.temp_olist_project.stg_customers"
[0m20:38:53.576992 [debug] [Thread-1 (]: On model.temp_olist_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.0b3", "profile_name": "temp_olist_project", "target_name": "dev", "node_id": "model.temp_olist_project.stg_customers"} */
alter table "olist_data"."olist_analytics"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m20:38:53.577666 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:38:53.585163 [debug] [Thread-1 (]: On model.temp_olist_project.stg_customers: COMMIT
[0m20:38:53.585373 [debug] [Thread-1 (]: Using postgres connection "model.temp_olist_project.stg_customers"
[0m20:38:53.585530 [debug] [Thread-1 (]: On model.temp_olist_project.stg_customers: COMMIT
[0m20:38:53.586608 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m20:38:53.589545 [debug] [Thread-1 (]: Applying DROP to: "olist_data"."olist_analytics"."stg_customers__dbt_backup"
[0m20:38:53.592042 [debug] [Thread-1 (]: Using postgres connection "model.temp_olist_project.stg_customers"
[0m20:38:53.592362 [debug] [Thread-1 (]: On model.temp_olist_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.0b3", "profile_name": "temp_olist_project", "target_name": "dev", "node_id": "model.temp_olist_project.stg_customers"} */
drop view if exists "olist_data"."olist_analytics"."stg_customers__dbt_backup" cascade
[0m20:38:53.598547 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.006 seconds
[0m20:38:53.599725 [debug] [Thread-1 (]: On model.temp_olist_project.stg_customers: Close
[0m20:38:53.600045 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a5b8ca46-b167-4ad8-942d-ae0ff97d0e26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1057497d0>]}
[0m20:38:53.600371 [info ] [Thread-1 (]: 1 of 3 OK created sql view model olist_analytics.stg_customers ................. [[32mCREATE VIEW[0m in 0.07s]
[0m20:38:53.600655 [debug] [Thread-1 (]: Finished running node model.temp_olist_project.stg_customers
[0m20:38:53.601040 [debug] [Thread-4 (]: Began running node model.temp_olist_project.customer_metrics
[0m20:38:53.601332 [info ] [Thread-4 (]: 3 of 3 START sql view model olist_analytics.customer_metrics ................... [RUN]
[0m20:38:53.601593 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.temp_olist_project.customer_metrics'
[0m20:38:53.601771 [debug] [Thread-4 (]: Began compiling node model.temp_olist_project.customer_metrics
[0m20:38:53.603215 [debug] [Thread-4 (]: Writing injected SQL for node "model.temp_olist_project.customer_metrics"
[0m20:38:53.603611 [debug] [Thread-4 (]: Began executing node model.temp_olist_project.customer_metrics
[0m20:38:53.605727 [debug] [Thread-4 (]: Writing runtime sql for node "model.temp_olist_project.customer_metrics"
[0m20:38:53.606223 [debug] [Thread-4 (]: Using postgres connection "model.temp_olist_project.customer_metrics"
[0m20:38:53.606409 [debug] [Thread-4 (]: On model.temp_olist_project.customer_metrics: BEGIN
[0m20:38:53.606575 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m20:38:53.613841 [debug] [Thread-4 (]: SQL status: BEGIN in 0.007 seconds
[0m20:38:53.614051 [debug] [Thread-4 (]: Using postgres connection "model.temp_olist_project.customer_metrics"
[0m20:38:53.614235 [debug] [Thread-4 (]: On model.temp_olist_project.customer_metrics: /* {"app": "dbt", "dbt_version": "1.9.0b3", "profile_name": "temp_olist_project", "target_name": "dev", "node_id": "model.temp_olist_project.customer_metrics"} */

  create view "olist_data"."olist_analytics"."customer_metrics__dbt_tmp"
    
    
  as (
    SELECT
    c.customer_id,
    c.customer_unique_id,
    c.customer_city,
    c.customer_state,
    co.total_orders,
    co.total_spent
FROM "olist_data"."olist_analytics"."stg_customers" c
LEFT JOIN customer_orders co ON c.customer_id = co.customer_id
  );
[0m20:38:53.615124 [debug] [Thread-4 (]: Postgres adapter: Postgres error: relation "customer_orders" does not exist
LINE 15: LEFT JOIN customer_orders co ON c.customer_id = co.customer_...
                   ^

[0m20:38:53.615304 [debug] [Thread-4 (]: On model.temp_olist_project.customer_metrics: ROLLBACK
[0m20:38:53.615615 [debug] [Thread-4 (]: On model.temp_olist_project.customer_metrics: Close
[0m20:38:53.617030 [debug] [Thread-4 (]: Database Error in model customer_metrics (models/transformations/customer_metrics.sql)
  relation "customer_orders" does not exist
  LINE 15: LEFT JOIN customer_orders co ON c.customer_id = co.customer_...
                     ^
  compiled code at target/run/temp_olist_project/models/transformations/customer_metrics.sql
[0m20:38:53.617284 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a5b8ca46-b167-4ad8-942d-ae0ff97d0e26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105694650>]}
[0m20:38:53.617601 [error] [Thread-4 (]: 3 of 3 ERROR creating sql view model olist_analytics.customer_metrics .......... [[31mERROR[0m in 0.02s]
[0m20:38:53.617874 [debug] [Thread-4 (]: Finished running node model.temp_olist_project.customer_metrics
[0m20:38:53.618131 [debug] [Thread-7 (]: Marking all children of 'model.temp_olist_project.customer_metrics' to be skipped because of status 'error'.  Reason: Database Error in model customer_metrics (models/transformations/customer_metrics.sql)
  relation "customer_orders" does not exist
  LINE 15: LEFT JOIN customer_orders co ON c.customer_id = co.customer_...
                     ^
  compiled code at target/run/temp_olist_project/models/transformations/customer_metrics.sql.
[0m20:38:53.618757 [debug] [MainThread]: Using postgres connection "master"
[0m20:38:53.618900 [debug] [MainThread]: On master: BEGIN
[0m20:38:53.619028 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:38:53.626513 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m20:38:53.626769 [debug] [MainThread]: On master: COMMIT
[0m20:38:53.626919 [debug] [MainThread]: Using postgres connection "master"
[0m20:38:53.627057 [debug] [MainThread]: On master: COMMIT
[0m20:38:53.627289 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:38:53.627432 [debug] [MainThread]: On master: Close
[0m20:38:53.627648 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:38:53.627780 [debug] [MainThread]: Connection 'model.temp_olist_project.stg_customers' was properly closed.
[0m20:38:53.627903 [debug] [MainThread]: Connection 'model.temp_olist_project.stg_orders' was properly closed.
[0m20:38:53.628024 [debug] [MainThread]: Connection 'model.temp_olist_project.customer_metrics' was properly closed.
[0m20:38:53.628210 [info ] [MainThread]: 
[0m20:38:53.628371 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 0.20 seconds (0.20s).
[0m20:38:53.628822 [debug] [MainThread]: Command end result
[0m20:38:53.643835 [info ] [MainThread]: 
[0m20:38:53.644104 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successs, and 0 warnings:[0m
[0m20:38:53.644264 [info ] [MainThread]: 
[0m20:38:53.644453 [error] [MainThread]:   Database Error in model stg_orders (models/staging/stg_orders.sql)
  operator does not exist: text - text
  LINE 16: ...   DATE_PART('day', order_estimated_delivery_date - order_de...
                                                                ^
  HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target/run/temp_olist_project/models/staging/stg_orders.sql
[0m20:38:53.644603 [info ] [MainThread]: 
[0m20:38:53.644765 [error] [MainThread]:   Database Error in model customer_metrics (models/transformations/customer_metrics.sql)
  relation "customer_orders" does not exist
  LINE 15: LEFT JOIN customer_orders co ON c.customer_id = co.customer_...
                     ^
  compiled code at target/run/temp_olist_project/models/transformations/customer_metrics.sql
[0m20:38:53.644902 [info ] [MainThread]: 
[0m20:38:53.645047 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=2 SKIP=0 TOTAL=3
[0m20:38:53.645892 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.5551248, "process_user_time": 0.971761, "process_kernel_time": 0.143497, "process_mem_max_rss": "127008768", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m20:38:53.646144 [debug] [MainThread]: Command `dbt run` failed at 20:38:53.646106 after 0.56 seconds
[0m20:38:53.646332 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1043f1e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1043f1e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100549ad0>]}
[0m20:38:53.646502 [debug] [MainThread]: Flushing usage events
[0m20:38:55.186158 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:39:25.300141 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a5bfd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ac9b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108aca4d0>]}


============================== 20:39:25.302267 | 84ab796b-28aa-4ee3-8a4f-1fe5d251928d ==============================
[0m20:39:25.302267 [info ] [MainThread]: Running with dbt=1.9.0-b3
[0m20:39:25.302584 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/sushmitha/Documents/projects/olist_dbt_project/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/sushmitha/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m20:39:25.371892 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '84ab796b-28aa-4ee3-8a4f-1fe5d251928d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108aacb90>]}
[0m20:39:25.394988 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '84ab796b-28aa-4ee3-8a4f-1fe5d251928d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b21250>]}
[0m20:39:25.395390 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m20:39:25.403066 [debug] [MainThread]: checksum: 5f4fde221ca8627174a0341efc73099aaec05b8546408ceed6f59b1ec0755115, vars: {}, profile: , target: , version: 1.9.0b3
[0m20:39:25.458144 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:39:25.458491 [debug] [MainThread]: Partial parsing: updated file: temp_olist_project://models/transformations/customer_metrics.sql
[0m20:39:25.558336 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.temp_olist_project.example
[0m20:39:25.564002 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '84ab796b-28aa-4ee3-8a4f-1fe5d251928d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109783650>]}
[0m20:39:25.608682 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '84ab796b-28aa-4ee3-8a4f-1fe5d251928d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109da6cd0>]}
[0m20:39:25.608981 [info ] [MainThread]: Found 3 models, 3 data tests, 11 sources, 428 macros
[0m20:39:25.609150 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '84ab796b-28aa-4ee3-8a4f-1fe5d251928d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109d5b8d0>]}
[0m20:39:25.610040 [info ] [MainThread]: 
[0m20:39:25.610204 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:39:25.610330 [info ] [MainThread]: 
[0m20:39:25.610566 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:39:25.612326 [debug] [ThreadPool]: Acquiring new postgres connection 'list_olist_data'
[0m20:39:25.637200 [debug] [ThreadPool]: Using postgres connection "list_olist_data"
[0m20:39:25.637440 [debug] [ThreadPool]: On list_olist_data: /* {"app": "dbt", "dbt_version": "1.9.0b3", "profile_name": "temp_olist_project", "target_name": "dev", "connection_name": "list_olist_data"} */

    select distinct nspname from pg_namespace
  
[0m20:39:25.637629 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:39:25.653358 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.016 seconds
[0m20:39:25.654210 [debug] [ThreadPool]: On list_olist_data: Close
[0m20:39:25.654908 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_olist_data, now list_olist_data_olist_analytics)
[0m20:39:25.657950 [debug] [ThreadPool]: Using postgres connection "list_olist_data_olist_analytics"
[0m20:39:25.658198 [debug] [ThreadPool]: On list_olist_data_olist_analytics: BEGIN
[0m20:39:25.658349 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:39:25.665600 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m20:39:25.665838 [debug] [ThreadPool]: Using postgres connection "list_olist_data_olist_analytics"
[0m20:39:25.665998 [debug] [ThreadPool]: On list_olist_data_olist_analytics: /* {"app": "dbt", "dbt_version": "1.9.0b3", "profile_name": "temp_olist_project", "target_name": "dev", "connection_name": "list_olist_data_olist_analytics"} */
select
      'olist_data' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'olist_analytics'
    union all
    select
      'olist_data' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'olist_analytics'
    union all
    select
      'olist_data' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'olist_analytics'
  
[0m20:39:25.672331 [debug] [ThreadPool]: SQL status: SELECT 12 in 0.006 seconds
[0m20:39:25.673143 [debug] [ThreadPool]: On list_olist_data_olist_analytics: ROLLBACK
[0m20:39:25.673508 [debug] [ThreadPool]: On list_olist_data_olist_analytics: Close
[0m20:39:25.676492 [debug] [MainThread]: Using postgres connection "master"
[0m20:39:25.676712 [debug] [MainThread]: On master: BEGIN
[0m20:39:25.676845 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:39:25.685495 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m20:39:25.685723 [debug] [MainThread]: Using postgres connection "master"
[0m20:39:25.685929 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0b3", "profile_name": "temp_olist_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:39:25.696407 [debug] [MainThread]: SQL status: SELECT 1 in 0.010 seconds
[0m20:39:25.697138 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '84ab796b-28aa-4ee3-8a4f-1fe5d251928d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b25690>]}
[0m20:39:25.697411 [debug] [MainThread]: On master: ROLLBACK
[0m20:39:25.697715 [debug] [MainThread]: Using postgres connection "master"
[0m20:39:25.697865 [debug] [MainThread]: On master: BEGIN
[0m20:39:25.698395 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m20:39:25.698572 [debug] [MainThread]: On master: COMMIT
[0m20:39:25.698706 [debug] [MainThread]: Using postgres connection "master"
[0m20:39:25.698833 [debug] [MainThread]: On master: COMMIT
[0m20:39:25.699577 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m20:39:25.699766 [debug] [MainThread]: On master: Close
[0m20:39:25.703122 [debug] [Thread-1 (]: Began running node model.temp_olist_project.stg_customers
[0m20:39:25.703498 [info ] [Thread-1 (]: 1 of 3 START sql view model olist_analytics.stg_customers ...................... [RUN]
[0m20:39:25.703967 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_olist_data_olist_analytics, now model.temp_olist_project.stg_customers)
[0m20:39:25.704165 [debug] [Thread-1 (]: Began compiling node model.temp_olist_project.stg_customers
[0m20:39:25.709435 [debug] [Thread-1 (]: Writing injected SQL for node "model.temp_olist_project.stg_customers"
[0m20:39:25.710052 [debug] [Thread-2 (]: Began running node model.temp_olist_project.stg_orders
[0m20:39:25.710359 [info ] [Thread-2 (]: 2 of 3 START sql view model olist_analytics.stg_orders ......................... [RUN]
[0m20:39:25.710903 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.temp_olist_project.stg_orders'
[0m20:39:25.711133 [debug] [Thread-2 (]: Began compiling node model.temp_olist_project.stg_orders
[0m20:39:25.712846 [debug] [Thread-2 (]: Writing injected SQL for node "model.temp_olist_project.stg_orders"
[0m20:39:25.713550 [debug] [Thread-2 (]: Began executing node model.temp_olist_project.stg_orders
[0m20:39:25.720486 [debug] [Thread-1 (]: Began executing node model.temp_olist_project.stg_customers
[0m20:39:25.734364 [debug] [Thread-2 (]: Writing runtime sql for node "model.temp_olist_project.stg_orders"
[0m20:39:25.736355 [debug] [Thread-1 (]: Writing runtime sql for node "model.temp_olist_project.stg_customers"
[0m20:39:25.736864 [debug] [Thread-2 (]: Using postgres connection "model.temp_olist_project.stg_orders"
[0m20:39:25.737069 [debug] [Thread-1 (]: Using postgres connection "model.temp_olist_project.stg_customers"
[0m20:39:25.737248 [debug] [Thread-2 (]: On model.temp_olist_project.stg_orders: BEGIN
[0m20:39:25.737413 [debug] [Thread-1 (]: On model.temp_olist_project.stg_customers: BEGIN
[0m20:39:25.737571 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m20:39:25.737711 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:39:25.745308 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m20:39:25.745487 [debug] [Thread-2 (]: SQL status: BEGIN in 0.008 seconds
[0m20:39:25.745670 [debug] [Thread-1 (]: Using postgres connection "model.temp_olist_project.stg_customers"
[0m20:39:25.745829 [debug] [Thread-2 (]: Using postgres connection "model.temp_olist_project.stg_orders"
[0m20:39:25.745998 [debug] [Thread-1 (]: On model.temp_olist_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.0b3", "profile_name": "temp_olist_project", "target_name": "dev", "node_id": "model.temp_olist_project.stg_customers"} */

  create view "olist_data"."olist_analytics"."stg_customers__dbt_tmp"
    
    
  as (
    -- models/staging/stg_customers.sql
WITH raw_customers AS (
    SELECT * FROM "olist_data"."olist_analytics"."olist_customers_dataset"
)
SELECT
    customer_id,
    customer_unique_id,
    customer_zip_code_prefix,
    customer_city,
    customer_state
FROM raw_customers
  );
[0m20:39:25.746183 [debug] [Thread-2 (]: On model.temp_olist_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.0b3", "profile_name": "temp_olist_project", "target_name": "dev", "node_id": "model.temp_olist_project.stg_orders"} */

  create view "olist_data"."olist_analytics"."stg_orders__dbt_tmp"
    
    
  as (
    -- models/staging/stg_orders.sql
WITH raw_orders AS (
    SELECT * FROM "olist_data"."olist_analytics"."olist_orders_dataset"
)
SELECT
    order_id,
    customer_id,
    order_purchase_timestamp,
    order_delivered_customer_date,
    DATE_PART('day', order_estimated_delivery_date - order_delivered_customer_date) AS delivery_delay
FROM raw_orders
WHERE order_status = 'delivered'
  );
[0m20:39:25.747058 [debug] [Thread-2 (]: Postgres adapter: Postgres error: operator does not exist: text - text
LINE 16: ...   DATE_PART('day', order_estimated_delivery_date - order_de...
                                                              ^
HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.

[0m20:39:25.747228 [debug] [Thread-2 (]: On model.temp_olist_project.stg_orders: ROLLBACK
[0m20:39:25.747546 [debug] [Thread-2 (]: On model.temp_olist_project.stg_orders: Close
[0m20:39:25.748928 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m20:39:25.752346 [debug] [Thread-1 (]: Using postgres connection "model.temp_olist_project.stg_customers"
[0m20:39:25.752633 [debug] [Thread-1 (]: On model.temp_olist_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.0b3", "profile_name": "temp_olist_project", "target_name": "dev", "node_id": "model.temp_olist_project.stg_customers"} */
alter table "olist_data"."olist_analytics"."stg_customers" rename to "stg_customers__dbt_backup"
[0m20:39:25.753525 [debug] [Thread-2 (]: Database Error in model stg_orders (models/staging/stg_orders.sql)
  operator does not exist: text - text
  LINE 16: ...   DATE_PART('day', order_estimated_delivery_date - order_de...
                                                                ^
  HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target/run/temp_olist_project/models/staging/stg_orders.sql
[0m20:39:25.754387 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m20:39:25.756850 [debug] [Thread-1 (]: Using postgres connection "model.temp_olist_project.stg_customers"
[0m20:39:25.757086 [debug] [Thread-1 (]: On model.temp_olist_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.0b3", "profile_name": "temp_olist_project", "target_name": "dev", "node_id": "model.temp_olist_project.stg_customers"} */
alter table "olist_data"."olist_analytics"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m20:39:25.757294 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '84ab796b-28aa-4ee3-8a4f-1fe5d251928d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10902cc90>]}
[0m20:39:25.757641 [error] [Thread-2 (]: 2 of 3 ERROR creating sql view model olist_analytics.stg_orders ................ [[31mERROR[0m in 0.04s]
[0m20:39:25.757926 [debug] [Thread-2 (]: Finished running node model.temp_olist_project.stg_orders
[0m20:39:25.758080 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:39:25.758292 [debug] [Thread-7 (]: Marking all children of 'model.temp_olist_project.stg_orders' to be skipped because of status 'error'.  Reason: Database Error in model stg_orders (models/staging/stg_orders.sql)
  operator does not exist: text - text
  LINE 16: ...   DATE_PART('day', order_estimated_delivery_date - order_de...
                                                                ^
  HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target/run/temp_olist_project/models/staging/stg_orders.sql.
[0m20:39:25.765817 [debug] [Thread-1 (]: On model.temp_olist_project.stg_customers: COMMIT
[0m20:39:25.766363 [debug] [Thread-1 (]: Using postgres connection "model.temp_olist_project.stg_customers"
[0m20:39:25.766524 [debug] [Thread-1 (]: On model.temp_olist_project.stg_customers: COMMIT
[0m20:39:25.767422 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m20:39:25.770337 [debug] [Thread-1 (]: Applying DROP to: "olist_data"."olist_analytics"."stg_customers__dbt_backup"
[0m20:39:25.772931 [debug] [Thread-1 (]: Using postgres connection "model.temp_olist_project.stg_customers"
[0m20:39:25.773221 [debug] [Thread-1 (]: On model.temp_olist_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.0b3", "profile_name": "temp_olist_project", "target_name": "dev", "node_id": "model.temp_olist_project.stg_customers"} */
drop view if exists "olist_data"."olist_analytics"."stg_customers__dbt_backup" cascade
[0m20:39:25.774793 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m20:39:25.776013 [debug] [Thread-1 (]: On model.temp_olist_project.stg_customers: Close
[0m20:39:25.776321 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '84ab796b-28aa-4ee3-8a4f-1fe5d251928d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aabbf50>]}
[0m20:39:25.776626 [info ] [Thread-1 (]: 1 of 3 OK created sql view model olist_analytics.stg_customers ................. [[32mCREATE VIEW[0m in 0.07s]
[0m20:39:25.776893 [debug] [Thread-1 (]: Finished running node model.temp_olist_project.stg_customers
[0m20:39:25.777247 [debug] [Thread-4 (]: Began running node model.temp_olist_project.customer_metrics
[0m20:39:25.777536 [info ] [Thread-4 (]: 3 of 3 START sql view model olist_analytics.customer_metrics ................... [RUN]
[0m20:39:25.777843 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.temp_olist_project.customer_metrics'
[0m20:39:25.778019 [debug] [Thread-4 (]: Began compiling node model.temp_olist_project.customer_metrics
[0m20:39:25.779370 [debug] [Thread-4 (]: Writing injected SQL for node "model.temp_olist_project.customer_metrics"
[0m20:39:25.779751 [debug] [Thread-4 (]: Began executing node model.temp_olist_project.customer_metrics
[0m20:39:25.781570 [debug] [Thread-4 (]: Writing runtime sql for node "model.temp_olist_project.customer_metrics"
[0m20:39:25.781866 [debug] [Thread-4 (]: Using postgres connection "model.temp_olist_project.customer_metrics"
[0m20:39:25.782016 [debug] [Thread-4 (]: On model.temp_olist_project.customer_metrics: BEGIN
[0m20:39:25.782153 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m20:39:25.789399 [debug] [Thread-4 (]: SQL status: BEGIN in 0.007 seconds
[0m20:39:25.789667 [debug] [Thread-4 (]: Using postgres connection "model.temp_olist_project.customer_metrics"
[0m20:39:25.789839 [debug] [Thread-4 (]: On model.temp_olist_project.customer_metrics: /* {"app": "dbt", "dbt_version": "1.9.0b3", "profile_name": "temp_olist_project", "target_name": "dev", "node_id": "model.temp_olist_project.customer_metrics"} */

  create view "olist_data"."olist_analytics"."customer_metrics__dbt_tmp"
    
    
  as (
    SELECT
    c.customer_id,
    c.customer_unique_id,
    c.customer_city,
    c.customer_state,
    co.total_orders,
    co.total_spent
FROM "olist_data"."olist_analytics"."stg_customers" c
LEFT JOIN customer_orders co ON c.customer_id = co.customer_id;
  );
[0m20:39:25.790283 [debug] [Thread-4 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 15: ...T JOIN customer_orders co ON c.customer_id = co.customer_id;
                                                                       ^

[0m20:39:25.790494 [debug] [Thread-4 (]: On model.temp_olist_project.customer_metrics: ROLLBACK
[0m20:39:25.790861 [debug] [Thread-4 (]: On model.temp_olist_project.customer_metrics: Close
[0m20:39:25.792280 [debug] [Thread-4 (]: Database Error in model customer_metrics (models/transformations/customer_metrics.sql)
  syntax error at or near ";"
  LINE 15: ...T JOIN customer_orders co ON c.customer_id = co.customer_id;
                                                                         ^
  compiled code at target/run/temp_olist_project/models/transformations/customer_metrics.sql
[0m20:39:25.792534 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '84ab796b-28aa-4ee3-8a4f-1fe5d251928d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109d9ab50>]}
[0m20:39:25.792841 [error] [Thread-4 (]: 3 of 3 ERROR creating sql view model olist_analytics.customer_metrics .......... [[31mERROR[0m in 0.01s]
[0m20:39:25.793099 [debug] [Thread-4 (]: Finished running node model.temp_olist_project.customer_metrics
[0m20:39:25.793332 [debug] [Thread-7 (]: Marking all children of 'model.temp_olist_project.customer_metrics' to be skipped because of status 'error'.  Reason: Database Error in model customer_metrics (models/transformations/customer_metrics.sql)
  syntax error at or near ";"
  LINE 15: ...T JOIN customer_orders co ON c.customer_id = co.customer_id;
                                                                         ^
  compiled code at target/run/temp_olist_project/models/transformations/customer_metrics.sql.
[0m20:39:25.794035 [debug] [MainThread]: Using postgres connection "master"
[0m20:39:25.794167 [debug] [MainThread]: On master: BEGIN
[0m20:39:25.794281 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:39:25.801035 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m20:39:25.801220 [debug] [MainThread]: On master: COMMIT
[0m20:39:25.801361 [debug] [MainThread]: Using postgres connection "master"
[0m20:39:25.801488 [debug] [MainThread]: On master: COMMIT
[0m20:39:25.801744 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:39:25.801873 [debug] [MainThread]: On master: Close
[0m20:39:25.802054 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:39:25.802174 [debug] [MainThread]: Connection 'model.temp_olist_project.stg_customers' was properly closed.
[0m20:39:25.802283 [debug] [MainThread]: Connection 'model.temp_olist_project.stg_orders' was properly closed.
[0m20:39:25.802390 [debug] [MainThread]: Connection 'model.temp_olist_project.customer_metrics' was properly closed.
[0m20:39:25.802549 [info ] [MainThread]: 
[0m20:39:25.802699 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 0.19 seconds (0.19s).
[0m20:39:25.803116 [debug] [MainThread]: Command end result
[0m20:39:25.817360 [info ] [MainThread]: 
[0m20:39:25.817633 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successs, and 0 warnings:[0m
[0m20:39:25.817792 [info ] [MainThread]: 
[0m20:39:25.817980 [error] [MainThread]:   Database Error in model stg_orders (models/staging/stg_orders.sql)
  operator does not exist: text - text
  LINE 16: ...   DATE_PART('day', order_estimated_delivery_date - order_de...
                                                                ^
  HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target/run/temp_olist_project/models/staging/stg_orders.sql
[0m20:39:25.818130 [info ] [MainThread]: 
[0m20:39:25.818295 [error] [MainThread]:   Database Error in model customer_metrics (models/transformations/customer_metrics.sql)
  syntax error at or near ";"
  LINE 15: ...T JOIN customer_orders co ON c.customer_id = co.customer_id;
                                                                         ^
  compiled code at target/run/temp_olist_project/models/transformations/customer_metrics.sql
[0m20:39:25.818440 [info ] [MainThread]: 
[0m20:39:25.818583 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=2 SKIP=0 TOTAL=3
[0m20:39:25.819518 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.5477685, "process_user_time": 0.973437, "process_kernel_time": 0.142358, "process_mem_max_rss": "126337024", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m20:39:25.819867 [debug] [MainThread]: Command `dbt run` failed at 20:39:25.819819 after 0.55 seconds
[0m20:39:25.820733 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c23f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ac9f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104cc4610>]}
[0m20:39:25.820989 [debug] [MainThread]: Flushing usage events
[0m20:39:27.413720 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:40:27.743648 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10881c450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10888db90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10888e550>]}


============================== 20:40:27.746876 | 1595ec26-1b0c-49b4-bd53-343f704b5353 ==============================
[0m20:40:27.746876 [info ] [MainThread]: Running with dbt=1.9.0-b3
[0m20:40:27.747254 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/sushmitha/Documents/projects/olist_dbt_project/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/sushmitha/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m20:40:27.828949 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1595ec26-1b0c-49b4-bd53-343f704b5353', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108870b90>]}
[0m20:40:27.851985 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1595ec26-1b0c-49b4-bd53-343f704b5353', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068e5510>]}
[0m20:40:27.852736 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m20:40:27.862879 [debug] [MainThread]: checksum: 5f4fde221ca8627174a0341efc73099aaec05b8546408ceed6f59b1ec0755115, vars: {}, profile: , target: , version: 1.9.0b3
[0m20:40:27.927551 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m20:40:27.927942 [debug] [MainThread]: Partial parsing: updated file: temp_olist_project://models/staging/stg_orders.sql
[0m20:40:27.928136 [debug] [MainThread]: Partial parsing: updated file: temp_olist_project://models/transformations/customer_metrics.sql
[0m20:40:28.097948 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.temp_olist_project.example
[0m20:40:28.103689 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1595ec26-1b0c-49b4-bd53-343f704b5353', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e80ed0>]}
[0m20:40:28.153464 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1595ec26-1b0c-49b4-bd53-343f704b5353', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10986ecd0>]}
[0m20:40:28.153783 [info ] [MainThread]: Found 3 models, 3 data tests, 11 sources, 428 macros
[0m20:40:28.153963 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1595ec26-1b0c-49b4-bd53-343f704b5353', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1097526d0>]}
[0m20:40:28.154880 [info ] [MainThread]: 
[0m20:40:28.155059 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:40:28.155188 [info ] [MainThread]: 
[0m20:40:28.155418 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:40:28.157164 [debug] [ThreadPool]: Acquiring new postgres connection 'list_olist_data'
[0m20:40:28.184571 [debug] [ThreadPool]: Using postgres connection "list_olist_data"
[0m20:40:28.184788 [debug] [ThreadPool]: On list_olist_data: /* {"app": "dbt", "dbt_version": "1.9.0b3", "profile_name": "temp_olist_project", "target_name": "dev", "connection_name": "list_olist_data"} */

    select distinct nspname from pg_namespace
  
[0m20:40:28.184932 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:40:28.217806 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.033 seconds
[0m20:40:28.218581 [debug] [ThreadPool]: On list_olist_data: Close
[0m20:40:28.219204 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_olist_data, now list_olist_data_olist_analytics)
[0m20:40:28.222217 [debug] [ThreadPool]: Using postgres connection "list_olist_data_olist_analytics"
[0m20:40:28.222390 [debug] [ThreadPool]: On list_olist_data_olist_analytics: BEGIN
[0m20:40:28.222524 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:40:28.232396 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m20:40:28.232580 [debug] [ThreadPool]: Using postgres connection "list_olist_data_olist_analytics"
[0m20:40:28.232764 [debug] [ThreadPool]: On list_olist_data_olist_analytics: /* {"app": "dbt", "dbt_version": "1.9.0b3", "profile_name": "temp_olist_project", "target_name": "dev", "connection_name": "list_olist_data_olist_analytics"} */
select
      'olist_data' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'olist_analytics'
    union all
    select
      'olist_data' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'olist_analytics'
    union all
    select
      'olist_data' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'olist_analytics'
  
[0m20:40:28.239333 [debug] [ThreadPool]: SQL status: SELECT 12 in 0.006 seconds
[0m20:40:28.240169 [debug] [ThreadPool]: On list_olist_data_olist_analytics: ROLLBACK
[0m20:40:28.240520 [debug] [ThreadPool]: On list_olist_data_olist_analytics: Close
[0m20:40:28.243796 [debug] [MainThread]: Using postgres connection "master"
[0m20:40:28.243981 [debug] [MainThread]: On master: BEGIN
[0m20:40:28.244127 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:40:28.255011 [debug] [MainThread]: SQL status: BEGIN in 0.011 seconds
[0m20:40:28.255183 [debug] [MainThread]: Using postgres connection "master"
[0m20:40:28.255418 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0b3", "profile_name": "temp_olist_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:40:28.268009 [debug] [MainThread]: SQL status: SELECT 1 in 0.012 seconds
[0m20:40:28.268788 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1595ec26-1b0c-49b4-bd53-343f704b5353', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109bdc9d0>]}
[0m20:40:28.269039 [debug] [MainThread]: On master: ROLLBACK
[0m20:40:28.269348 [debug] [MainThread]: Using postgres connection "master"
[0m20:40:28.269510 [debug] [MainThread]: On master: BEGIN
[0m20:40:28.269884 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m20:40:28.270052 [debug] [MainThread]: On master: COMMIT
[0m20:40:28.270199 [debug] [MainThread]: Using postgres connection "master"
[0m20:40:28.270343 [debug] [MainThread]: On master: COMMIT
[0m20:40:28.270594 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:40:28.270772 [debug] [MainThread]: On master: Close
[0m20:40:28.272189 [debug] [Thread-1 (]: Began running node model.temp_olist_project.stg_customers
[0m20:40:28.272404 [debug] [Thread-2 (]: Began running node model.temp_olist_project.stg_orders
[0m20:40:28.272825 [info ] [Thread-1 (]: 1 of 3 START sql view model olist_analytics.stg_customers ...................... [RUN]
[0m20:40:28.273156 [info ] [Thread-2 (]: 2 of 3 START sql view model olist_analytics.stg_orders ......................... [RUN]
[0m20:40:28.273436 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_olist_data_olist_analytics, now model.temp_olist_project.stg_customers)
[0m20:40:28.273728 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.temp_olist_project.stg_orders'
[0m20:40:28.273943 [debug] [Thread-1 (]: Began compiling node model.temp_olist_project.stg_customers
[0m20:40:28.274139 [debug] [Thread-2 (]: Began compiling node model.temp_olist_project.stg_orders
[0m20:40:28.278506 [debug] [Thread-1 (]: Writing injected SQL for node "model.temp_olist_project.stg_customers"
[0m20:40:28.280105 [debug] [Thread-2 (]: Writing injected SQL for node "model.temp_olist_project.stg_orders"
[0m20:40:28.280589 [debug] [Thread-1 (]: Began executing node model.temp_olist_project.stg_customers
[0m20:40:28.287250 [debug] [Thread-2 (]: Began executing node model.temp_olist_project.stg_orders
[0m20:40:28.299581 [debug] [Thread-1 (]: Writing runtime sql for node "model.temp_olist_project.stg_customers"
[0m20:40:28.301610 [debug] [Thread-2 (]: Writing runtime sql for node "model.temp_olist_project.stg_orders"
[0m20:40:28.302093 [debug] [Thread-2 (]: Using postgres connection "model.temp_olist_project.stg_orders"
[0m20:40:28.302310 [debug] [Thread-1 (]: Using postgres connection "model.temp_olist_project.stg_customers"
[0m20:40:28.302513 [debug] [Thread-2 (]: On model.temp_olist_project.stg_orders: BEGIN
[0m20:40:28.302696 [debug] [Thread-1 (]: On model.temp_olist_project.stg_customers: BEGIN
[0m20:40:28.302859 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m20:40:28.303012 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:40:28.312595 [debug] [Thread-2 (]: SQL status: BEGIN in 0.010 seconds
[0m20:40:28.312809 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m20:40:28.313012 [debug] [Thread-2 (]: Using postgres connection "model.temp_olist_project.stg_orders"
[0m20:40:28.313194 [debug] [Thread-1 (]: Using postgres connection "model.temp_olist_project.stg_customers"
[0m20:40:28.313388 [debug] [Thread-2 (]: On model.temp_olist_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.0b3", "profile_name": "temp_olist_project", "target_name": "dev", "node_id": "model.temp_olist_project.stg_orders"} */

  create view "olist_data"."olist_analytics"."stg_orders__dbt_tmp"
    
    
  as (
    -- models/staging/stg_orders.sql
WITH raw_orders AS (
    SELECT * FROM "olist_data"."olist_analytics"."olist_orders_dataset"
)
SELECT
    order_id,
    customer_id,
    order_purchase_timestamp,
    order_delivered_customer_date::date AS order_delivered_customer_date,
    order_estimated_delivery_date::date AS order_estimated_delivery_date,
    DATE_PART('day', order_estimated_delivery_date::date - order_delivered_customer_date::date) AS delivery_delay
FROM raw_orders
WHERE order_status = 'delivered'
  );
[0m20:40:28.313611 [debug] [Thread-1 (]: On model.temp_olist_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.0b3", "profile_name": "temp_olist_project", "target_name": "dev", "node_id": "model.temp_olist_project.stg_customers"} */

  create view "olist_data"."olist_analytics"."stg_customers__dbt_tmp"
    
    
  as (
    -- models/staging/stg_customers.sql
WITH raw_customers AS (
    SELECT * FROM "olist_data"."olist_analytics"."olist_customers_dataset"
)
SELECT
    customer_id,
    customer_unique_id,
    customer_zip_code_prefix,
    customer_city,
    customer_state
FROM raw_customers
  );
[0m20:40:28.317308 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m20:40:28.317528 [debug] [Thread-2 (]: Postgres adapter: Postgres error: function date_part(unknown, integer) does not exist
LINE 17:     DATE_PART('day', order_estimated_delivery_date::date - o...
             ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[0m20:40:28.321189 [debug] [Thread-1 (]: Using postgres connection "model.temp_olist_project.stg_customers"
[0m20:40:28.321409 [debug] [Thread-2 (]: On model.temp_olist_project.stg_orders: ROLLBACK
[0m20:40:28.321597 [debug] [Thread-1 (]: On model.temp_olist_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.0b3", "profile_name": "temp_olist_project", "target_name": "dev", "node_id": "model.temp_olist_project.stg_customers"} */
alter table "olist_data"."olist_analytics"."stg_customers" rename to "stg_customers__dbt_backup"
[0m20:40:28.322020 [debug] [Thread-2 (]: On model.temp_olist_project.stg_orders: Close
[0m20:40:28.322844 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:40:28.324412 [debug] [Thread-1 (]: Using postgres connection "model.temp_olist_project.stg_customers"
[0m20:40:28.324612 [debug] [Thread-1 (]: On model.temp_olist_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.0b3", "profile_name": "temp_olist_project", "target_name": "dev", "node_id": "model.temp_olist_project.stg_customers"} */
alter table "olist_data"."olist_analytics"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m20:40:28.325314 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:40:28.333194 [debug] [Thread-1 (]: On model.temp_olist_project.stg_customers: COMMIT
[0m20:40:28.333394 [debug] [Thread-1 (]: Using postgres connection "model.temp_olist_project.stg_customers"
[0m20:40:28.333593 [debug] [Thread-1 (]: On model.temp_olist_project.stg_customers: COMMIT
[0m20:40:28.336399 [debug] [Thread-2 (]: Database Error in model stg_orders (models/staging/stg_orders.sql)
  function date_part(unknown, integer) does not exist
  LINE 17:     DATE_PART('day', order_estimated_delivery_date::date - o...
               ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target/run/temp_olist_project/models/staging/stg_orders.sql
[0m20:40:28.337330 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1595ec26-1b0c-49b4-bd53-343f704b5353', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109753510>]}
[0m20:40:28.337660 [error] [Thread-2 (]: 2 of 3 ERROR creating sql view model olist_analytics.stg_orders ................ [[31mERROR[0m in 0.06s]
[0m20:40:28.337940 [debug] [Thread-2 (]: Finished running node model.temp_olist_project.stg_orders
[0m20:40:28.338185 [debug] [Thread-7 (]: Marking all children of 'model.temp_olist_project.stg_orders' to be skipped because of status 'error'.  Reason: Database Error in model stg_orders (models/staging/stg_orders.sql)
  function date_part(unknown, integer) does not exist
  LINE 17:     DATE_PART('day', order_estimated_delivery_date::date - o...
               ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target/run/temp_olist_project/models/staging/stg_orders.sql.
[0m20:40:28.339481 [debug] [Thread-1 (]: SQL status: COMMIT in 0.006 seconds
[0m20:40:28.342549 [debug] [Thread-1 (]: Applying DROP to: "olist_data"."olist_analytics"."stg_customers__dbt_backup"
[0m20:40:28.345001 [debug] [Thread-1 (]: Using postgres connection "model.temp_olist_project.stg_customers"
[0m20:40:28.345190 [debug] [Thread-1 (]: On model.temp_olist_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.0b3", "profile_name": "temp_olist_project", "target_name": "dev", "node_id": "model.temp_olist_project.stg_customers"} */
drop view if exists "olist_data"."olist_analytics"."stg_customers__dbt_backup" cascade
[0m20:40:28.346508 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m20:40:28.347575 [debug] [Thread-1 (]: On model.temp_olist_project.stg_customers: Close
[0m20:40:28.347856 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1595ec26-1b0c-49b4-bd53-343f704b5353', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109bdc090>]}
[0m20:40:28.348145 [info ] [Thread-1 (]: 1 of 3 OK created sql view model olist_analytics.stg_customers ................. [[32mCREATE VIEW[0m in 0.07s]
[0m20:40:28.348394 [debug] [Thread-1 (]: Finished running node model.temp_olist_project.stg_customers
[0m20:40:28.348706 [debug] [Thread-4 (]: Began running node model.temp_olist_project.customer_metrics
[0m20:40:28.348929 [info ] [Thread-4 (]: 3 of 3 SKIP relation olist_analytics.customer_metrics .......................... [[33mSKIP[0m]
[0m20:40:28.349111 [debug] [Thread-4 (]: Finished running node model.temp_olist_project.customer_metrics
[0m20:40:28.349589 [debug] [MainThread]: Using postgres connection "master"
[0m20:40:28.349735 [debug] [MainThread]: On master: BEGIN
[0m20:40:28.349863 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:40:28.363534 [debug] [MainThread]: SQL status: BEGIN in 0.014 seconds
[0m20:40:28.363812 [debug] [MainThread]: On master: COMMIT
[0m20:40:28.363968 [debug] [MainThread]: Using postgres connection "master"
[0m20:40:28.364110 [debug] [MainThread]: On master: COMMIT
[0m20:40:28.365624 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m20:40:28.366486 [debug] [MainThread]: On master: Close
[0m20:40:28.366711 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:40:28.367081 [debug] [MainThread]: Connection 'model.temp_olist_project.stg_customers' was properly closed.
[0m20:40:28.367217 [debug] [MainThread]: Connection 'model.temp_olist_project.stg_orders' was properly closed.
[0m20:40:28.367409 [info ] [MainThread]: 
[0m20:40:28.367579 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 0.21 seconds (0.21s).
[0m20:40:28.368001 [debug] [MainThread]: Command end result
[0m20:40:28.417021 [info ] [MainThread]: 
[0m20:40:28.417287 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successs, and 0 warnings:[0m
[0m20:40:28.417446 [info ] [MainThread]: 
[0m20:40:28.417631 [error] [MainThread]:   Database Error in model stg_orders (models/staging/stg_orders.sql)
  function date_part(unknown, integer) does not exist
  LINE 17:     DATE_PART('day', order_estimated_delivery_date::date - o...
               ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target/run/temp_olist_project/models/staging/stg_orders.sql
[0m20:40:28.417778 [info ] [MainThread]: 
[0m20:40:28.417923 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=1 TOTAL=3
[0m20:40:28.419383 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.7111608, "process_user_time": 1.06386, "process_kernel_time": 0.177289, "process_mem_max_rss": "128385024", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m20:40:28.419734 [debug] [MainThread]: Command `dbt run` failed at 20:40:28.419690 after 0.71 seconds
[0m20:40:28.419935 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109d571d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109d57490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109d57190>]}
[0m20:40:28.420126 [debug] [MainThread]: Flushing usage events
[0m20:40:30.546792 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:41:00.042666 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11aa3fd10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11aaadb90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11aaae550>]}


============================== 20:41:00.045403 | f1c7cc83-8c67-497b-8906-8ad36760d26d ==============================
[0m20:41:00.045403 [info ] [MainThread]: Running with dbt=1.9.0-b3
[0m20:41:00.045722 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/sushmitha/.dbt', 'log_path': '/Users/sushmitha/Documents/projects/olist_dbt_project/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m20:41:00.134046 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f1c7cc83-8c67-497b-8906-8ad36760d26d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11ae0a3d0>]}
[0m20:41:00.157793 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f1c7cc83-8c67-497b-8906-8ad36760d26d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078a5790>]}
[0m20:41:00.158278 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m20:41:00.168040 [debug] [MainThread]: checksum: 5f4fde221ca8627174a0341efc73099aaec05b8546408ceed6f59b1ec0755115, vars: {}, profile: , target: , version: 1.9.0b3
[0m20:41:00.234498 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:41:00.234742 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:41:00.237208 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.temp_olist_project.example
[0m20:41:00.256132 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f1c7cc83-8c67-497b-8906-8ad36760d26d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b05ed10>]}
[0m20:41:00.307649 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f1c7cc83-8c67-497b-8906-8ad36760d26d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11af13ad0>]}
[0m20:41:00.307952 [info ] [MainThread]: Found 3 models, 3 data tests, 11 sources, 428 macros
[0m20:41:00.308115 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f1c7cc83-8c67-497b-8906-8ad36760d26d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b70e690>]}
[0m20:41:00.309022 [info ] [MainThread]: 
[0m20:41:00.309199 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:41:00.309330 [info ] [MainThread]: 
[0m20:41:00.309570 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:41:00.311323 [debug] [ThreadPool]: Acquiring new postgres connection 'list_olist_data'
[0m20:41:00.339883 [debug] [ThreadPool]: Using postgres connection "list_olist_data"
[0m20:41:00.340127 [debug] [ThreadPool]: On list_olist_data: /* {"app": "dbt", "dbt_version": "1.9.0b3", "profile_name": "temp_olist_project", "target_name": "dev", "connection_name": "list_olist_data"} */

    select distinct nspname from pg_namespace
  
[0m20:41:00.340269 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:41:00.371502 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.031 seconds
[0m20:41:00.372308 [debug] [ThreadPool]: On list_olist_data: Close
[0m20:41:00.372988 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_olist_data, now list_olist_data_olist_analytics)
[0m20:41:00.376207 [debug] [ThreadPool]: Using postgres connection "list_olist_data_olist_analytics"
[0m20:41:00.376407 [debug] [ThreadPool]: On list_olist_data_olist_analytics: BEGIN
[0m20:41:00.376558 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:41:00.383419 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m20:41:00.383592 [debug] [ThreadPool]: Using postgres connection "list_olist_data_olist_analytics"
[0m20:41:00.383754 [debug] [ThreadPool]: On list_olist_data_olist_analytics: /* {"app": "dbt", "dbt_version": "1.9.0b3", "profile_name": "temp_olist_project", "target_name": "dev", "connection_name": "list_olist_data_olist_analytics"} */
select
      'olist_data' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'olist_analytics'
    union all
    select
      'olist_data' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'olist_analytics'
    union all
    select
      'olist_data' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'olist_analytics'
  
[0m20:41:00.389376 [debug] [ThreadPool]: SQL status: SELECT 12 in 0.005 seconds
[0m20:41:00.390195 [debug] [ThreadPool]: On list_olist_data_olist_analytics: ROLLBACK
[0m20:41:00.390560 [debug] [ThreadPool]: On list_olist_data_olist_analytics: Close
[0m20:41:00.393895 [debug] [MainThread]: Using postgres connection "master"
[0m20:41:00.394068 [debug] [MainThread]: On master: BEGIN
[0m20:41:00.394228 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:41:00.403366 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m20:41:00.403535 [debug] [MainThread]: Using postgres connection "master"
[0m20:41:00.403761 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0b3", "profile_name": "temp_olist_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:41:00.416149 [debug] [MainThread]: SQL status: SELECT 1 in 0.012 seconds
[0m20:41:00.416925 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f1c7cc83-8c67-497b-8906-8ad36760d26d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b9c3b90>]}
[0m20:41:00.417179 [debug] [MainThread]: On master: ROLLBACK
[0m20:41:00.417496 [debug] [MainThread]: Using postgres connection "master"
[0m20:41:00.417653 [debug] [MainThread]: On master: BEGIN
[0m20:41:00.418044 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m20:41:00.418207 [debug] [MainThread]: On master: COMMIT
[0m20:41:00.418360 [debug] [MainThread]: Using postgres connection "master"
[0m20:41:00.418523 [debug] [MainThread]: On master: COMMIT
[0m20:41:00.418791 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:41:00.418963 [debug] [MainThread]: On master: Close
[0m20:41:00.420360 [debug] [Thread-1 (]: Began running node model.temp_olist_project.stg_customers
[0m20:41:00.420604 [debug] [Thread-2 (]: Began running node model.temp_olist_project.stg_orders
[0m20:41:00.420996 [info ] [Thread-1 (]: 1 of 3 START sql view model olist_analytics.stg_customers ...................... [RUN]
[0m20:41:00.421264 [info ] [Thread-2 (]: 2 of 3 START sql view model olist_analytics.stg_orders ......................... [RUN]
[0m20:41:00.421530 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_olist_data_olist_analytics, now model.temp_olist_project.stg_customers)
[0m20:41:00.421793 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.temp_olist_project.stg_orders'
[0m20:41:00.421986 [debug] [Thread-1 (]: Began compiling node model.temp_olist_project.stg_customers
[0m20:41:00.422168 [debug] [Thread-2 (]: Began compiling node model.temp_olist_project.stg_orders
[0m20:41:00.426422 [debug] [Thread-1 (]: Writing injected SQL for node "model.temp_olist_project.stg_customers"
[0m20:41:00.428136 [debug] [Thread-2 (]: Writing injected SQL for node "model.temp_olist_project.stg_orders"
[0m20:41:00.428652 [debug] [Thread-1 (]: Began executing node model.temp_olist_project.stg_customers
[0m20:41:00.435206 [debug] [Thread-2 (]: Began executing node model.temp_olist_project.stg_orders
[0m20:41:00.447168 [debug] [Thread-1 (]: Writing runtime sql for node "model.temp_olist_project.stg_customers"
[0m20:41:00.449110 [debug] [Thread-2 (]: Writing runtime sql for node "model.temp_olist_project.stg_orders"
[0m20:41:00.449593 [debug] [Thread-1 (]: Using postgres connection "model.temp_olist_project.stg_customers"
[0m20:41:00.449795 [debug] [Thread-2 (]: Using postgres connection "model.temp_olist_project.stg_orders"
[0m20:41:00.449953 [debug] [Thread-1 (]: On model.temp_olist_project.stg_customers: BEGIN
[0m20:41:00.450109 [debug] [Thread-2 (]: On model.temp_olist_project.stg_orders: BEGIN
[0m20:41:00.450260 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:41:00.450404 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m20:41:00.458259 [debug] [Thread-2 (]: SQL status: BEGIN in 0.008 seconds
[0m20:41:00.458492 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m20:41:00.458694 [debug] [Thread-2 (]: Using postgres connection "model.temp_olist_project.stg_orders"
[0m20:41:00.458860 [debug] [Thread-1 (]: Using postgres connection "model.temp_olist_project.stg_customers"
[0m20:41:00.459041 [debug] [Thread-2 (]: On model.temp_olist_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.0b3", "profile_name": "temp_olist_project", "target_name": "dev", "node_id": "model.temp_olist_project.stg_orders"} */

  create view "olist_data"."olist_analytics"."stg_orders__dbt_tmp"
    
    
  as (
    -- models/staging/stg_orders.sql
WITH raw_orders AS (
    SELECT * FROM "olist_data"."olist_analytics"."olist_orders_dataset"
)
SELECT
    order_id,
    customer_id,
    order_purchase_timestamp,
    order_delivered_customer_date::date AS order_delivered_customer_date,
    order_estimated_delivery_date::date AS order_estimated_delivery_date,
    DATE_PART('day', order_estimated_delivery_date::date - order_delivered_customer_date::date) AS delivery_delay
FROM raw_orders
WHERE order_status = 'delivered'
  );
[0m20:41:00.459233 [debug] [Thread-1 (]: On model.temp_olist_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.0b3", "profile_name": "temp_olist_project", "target_name": "dev", "node_id": "model.temp_olist_project.stg_customers"} */

  create view "olist_data"."olist_analytics"."stg_customers__dbt_tmp"
    
    
  as (
    -- models/staging/stg_customers.sql
WITH raw_customers AS (
    SELECT * FROM "olist_data"."olist_analytics"."olist_customers_dataset"
)
SELECT
    customer_id,
    customer_unique_id,
    customer_zip_code_prefix,
    customer_city,
    customer_state
FROM raw_customers
  );
[0m20:41:00.460051 [debug] [Thread-2 (]: Postgres adapter: Postgres error: function date_part(unknown, integer) does not exist
LINE 17:     DATE_PART('day', order_estimated_delivery_date::date - o...
             ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[0m20:41:00.460236 [debug] [Thread-2 (]: On model.temp_olist_project.stg_orders: ROLLBACK
[0m20:41:00.460601 [debug] [Thread-2 (]: On model.temp_olist_project.stg_orders: Close
[0m20:41:00.461375 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m20:41:00.464681 [debug] [Thread-1 (]: Using postgres connection "model.temp_olist_project.stg_customers"
[0m20:41:00.464894 [debug] [Thread-1 (]: On model.temp_olist_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.0b3", "profile_name": "temp_olist_project", "target_name": "dev", "node_id": "model.temp_olist_project.stg_customers"} */
alter table "olist_data"."olist_analytics"."stg_customers" rename to "stg_customers__dbt_backup"
[0m20:41:00.465664 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:41:00.467132 [debug] [Thread-1 (]: Using postgres connection "model.temp_olist_project.stg_customers"
[0m20:41:00.467319 [debug] [Thread-1 (]: On model.temp_olist_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.0b3", "profile_name": "temp_olist_project", "target_name": "dev", "node_id": "model.temp_olist_project.stg_customers"} */
alter table "olist_data"."olist_analytics"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m20:41:00.467971 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:41:00.475602 [debug] [Thread-1 (]: On model.temp_olist_project.stg_customers: COMMIT
[0m20:41:00.475838 [debug] [Thread-1 (]: Using postgres connection "model.temp_olist_project.stg_customers"
[0m20:41:00.476047 [debug] [Thread-1 (]: On model.temp_olist_project.stg_customers: COMMIT
[0m20:41:00.478011 [debug] [Thread-2 (]: Database Error in model stg_orders (models/staging/stg_orders.sql)
  function date_part(unknown, integer) does not exist
  LINE 17:     DATE_PART('day', order_estimated_delivery_date::date - o...
               ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target/run/temp_olist_project/models/staging/stg_orders.sql
[0m20:41:00.478963 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f1c7cc83-8c67-497b-8906-8ad36760d26d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11ba7fb10>]}
[0m20:41:00.479130 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m20:41:00.479452 [error] [Thread-2 (]: 2 of 3 ERROR creating sql view model olist_analytics.stg_orders ................ [[31mERROR[0m in 0.06s]
[0m20:41:00.482535 [debug] [Thread-1 (]: Applying DROP to: "olist_data"."olist_analytics"."stg_customers__dbt_backup"
[0m20:41:00.482833 [debug] [Thread-2 (]: Finished running node model.temp_olist_project.stg_orders
[0m20:41:00.485313 [debug] [Thread-1 (]: Using postgres connection "model.temp_olist_project.stg_customers"
[0m20:41:00.485638 [debug] [Thread-7 (]: Marking all children of 'model.temp_olist_project.stg_orders' to be skipped because of status 'error'.  Reason: Database Error in model stg_orders (models/staging/stg_orders.sql)
  function date_part(unknown, integer) does not exist
  LINE 17:     DATE_PART('day', order_estimated_delivery_date::date - o...
               ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target/run/temp_olist_project/models/staging/stg_orders.sql.
[0m20:41:00.485840 [debug] [Thread-1 (]: On model.temp_olist_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.0b3", "profile_name": "temp_olist_project", "target_name": "dev", "node_id": "model.temp_olist_project.stg_customers"} */
drop view if exists "olist_data"."olist_analytics"."stg_customers__dbt_backup" cascade
[0m20:41:00.487600 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m20:41:00.488987 [debug] [Thread-1 (]: On model.temp_olist_project.stg_customers: Close
[0m20:41:00.489291 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f1c7cc83-8c67-497b-8906-8ad36760d26d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b77b750>]}
[0m20:41:00.489584 [info ] [Thread-1 (]: 1 of 3 OK created sql view model olist_analytics.stg_customers ................. [[32mCREATE VIEW[0m in 0.07s]
[0m20:41:00.489832 [debug] [Thread-1 (]: Finished running node model.temp_olist_project.stg_customers
[0m20:41:00.490199 [debug] [Thread-4 (]: Began running node model.temp_olist_project.customer_metrics
[0m20:41:00.490410 [info ] [Thread-4 (]: 3 of 3 SKIP relation olist_analytics.customer_metrics .......................... [[33mSKIP[0m]
[0m20:41:00.490586 [debug] [Thread-4 (]: Finished running node model.temp_olist_project.customer_metrics
[0m20:41:00.491073 [debug] [MainThread]: Using postgres connection "master"
[0m20:41:00.491211 [debug] [MainThread]: On master: BEGIN
[0m20:41:00.491331 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:41:00.497469 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m20:41:00.497628 [debug] [MainThread]: On master: COMMIT
[0m20:41:00.497751 [debug] [MainThread]: Using postgres connection "master"
[0m20:41:00.497865 [debug] [MainThread]: On master: COMMIT
[0m20:41:00.498132 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:41:00.498258 [debug] [MainThread]: On master: Close
[0m20:41:00.498425 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:41:00.498541 [debug] [MainThread]: Connection 'model.temp_olist_project.stg_customers' was properly closed.
[0m20:41:00.498649 [debug] [MainThread]: Connection 'model.temp_olist_project.stg_orders' was properly closed.
[0m20:41:00.498805 [info ] [MainThread]: 
[0m20:41:00.498948 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 0.19 seconds (0.19s).
[0m20:41:00.499296 [debug] [MainThread]: Command end result
[0m20:41:00.513553 [info ] [MainThread]: 
[0m20:41:00.513796 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successs, and 0 warnings:[0m
[0m20:41:00.513945 [info ] [MainThread]: 
[0m20:41:00.514118 [error] [MainThread]:   Database Error in model stg_orders (models/staging/stg_orders.sql)
  function date_part(unknown, integer) does not exist
  LINE 17:     DATE_PART('day', order_estimated_delivery_date::date - o...
               ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target/run/temp_olist_project/models/staging/stg_orders.sql
[0m20:41:00.514261 [info ] [MainThread]: 
[0m20:41:00.514399 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=1 TOTAL=3
[0m20:41:00.515897 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.50568974, "process_user_time": 0.885438, "process_kernel_time": 0.171267, "process_mem_max_rss": "121405440", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m20:41:00.516201 [debug] [MainThread]: Command `dbt run` failed at 20:41:00.516155 after 0.51 seconds
[0m20:41:00.516414 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e5ff50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119c852d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11aeb6e90>]}
[0m20:41:00.516594 [debug] [MainThread]: Flushing usage events
[0m20:41:01.767509 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:41:15.667271 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1043a3210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104411c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1044125d0>]}


============================== 20:41:15.669505 | 4b0074a2-7bfc-40b0-a427-fdbbc603cc33 ==============================
[0m20:41:15.669505 [info ] [MainThread]: Running with dbt=1.9.0-b3
[0m20:41:15.669829 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/sushmitha/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/sushmitha/Documents/projects/olist_dbt_project/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m20:41:15.740478 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4b0074a2-7bfc-40b0-a427-fdbbc603cc33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048d89d0>]}
[0m20:41:15.763562 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4b0074a2-7bfc-40b0-a427-fdbbc603cc33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1024696d0>]}
[0m20:41:15.763960 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m20:41:15.771979 [debug] [MainThread]: checksum: 5f4fde221ca8627174a0341efc73099aaec05b8546408ceed6f59b1ec0755115, vars: {}, profile: , target: , version: 1.9.0b3
[0m20:41:15.827132 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:41:15.827376 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:41:15.829827 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.temp_olist_project.example
[0m20:41:15.848287 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4b0074a2-7bfc-40b0-a427-fdbbc603cc33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048c0190>]}
[0m20:41:15.893304 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4b0074a2-7bfc-40b0-a427-fdbbc603cc33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048f9210>]}
[0m20:41:15.893613 [info ] [MainThread]: Found 3 models, 3 data tests, 11 sources, 428 macros
[0m20:41:15.893781 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4b0074a2-7bfc-40b0-a427-fdbbc603cc33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049e7690>]}
[0m20:41:15.894660 [info ] [MainThread]: 
[0m20:41:15.894826 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:41:15.894952 [info ] [MainThread]: 
[0m20:41:15.895200 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:41:15.896934 [debug] [ThreadPool]: Acquiring new postgres connection 'list_olist_data'
[0m20:41:15.922449 [debug] [ThreadPool]: Using postgres connection "list_olist_data"
[0m20:41:15.922680 [debug] [ThreadPool]: On list_olist_data: /* {"app": "dbt", "dbt_version": "1.9.0b3", "profile_name": "temp_olist_project", "target_name": "dev", "connection_name": "list_olist_data"} */

    select distinct nspname from pg_namespace
  
[0m20:41:15.922818 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:41:15.939294 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.016 seconds
[0m20:41:15.940030 [debug] [ThreadPool]: On list_olist_data: Close
[0m20:41:15.940662 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_olist_data, now list_olist_data_olist_analytics)
[0m20:41:15.943477 [debug] [ThreadPool]: Using postgres connection "list_olist_data_olist_analytics"
[0m20:41:15.943667 [debug] [ThreadPool]: On list_olist_data_olist_analytics: BEGIN
[0m20:41:15.943805 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:41:15.953520 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m20:41:15.953687 [debug] [ThreadPool]: Using postgres connection "list_olist_data_olist_analytics"
[0m20:41:15.953838 [debug] [ThreadPool]: On list_olist_data_olist_analytics: /* {"app": "dbt", "dbt_version": "1.9.0b3", "profile_name": "temp_olist_project", "target_name": "dev", "connection_name": "list_olist_data_olist_analytics"} */
select
      'olist_data' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'olist_analytics'
    union all
    select
      'olist_data' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'olist_analytics'
    union all
    select
      'olist_data' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'olist_analytics'
  
[0m20:41:15.960331 [debug] [ThreadPool]: SQL status: SELECT 12 in 0.006 seconds
[0m20:41:15.961021 [debug] [ThreadPool]: On list_olist_data_olist_analytics: ROLLBACK
[0m20:41:15.961355 [debug] [ThreadPool]: On list_olist_data_olist_analytics: Close
[0m20:41:15.964110 [debug] [MainThread]: Using postgres connection "master"
[0m20:41:15.964266 [debug] [MainThread]: On master: BEGIN
[0m20:41:15.964392 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:41:15.974411 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m20:41:15.974591 [debug] [MainThread]: Using postgres connection "master"
[0m20:41:15.974821 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0b3", "profile_name": "temp_olist_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:41:15.986978 [debug] [MainThread]: SQL status: SELECT 1 in 0.012 seconds
[0m20:41:15.987815 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4b0074a2-7bfc-40b0-a427-fdbbc603cc33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104cac990>]}
[0m20:41:15.988085 [debug] [MainThread]: On master: ROLLBACK
[0m20:41:15.988407 [debug] [MainThread]: Using postgres connection "master"
[0m20:41:15.988571 [debug] [MainThread]: On master: BEGIN
[0m20:41:15.988975 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m20:41:15.989143 [debug] [MainThread]: On master: COMMIT
[0m20:41:15.989291 [debug] [MainThread]: Using postgres connection "master"
[0m20:41:15.989437 [debug] [MainThread]: On master: COMMIT
[0m20:41:15.989702 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:41:15.989864 [debug] [MainThread]: On master: Close
[0m20:41:15.991088 [debug] [Thread-1 (]: Began running node model.temp_olist_project.stg_customers
[0m20:41:15.991308 [debug] [Thread-2 (]: Began running node model.temp_olist_project.stg_orders
[0m20:41:15.991681 [info ] [Thread-1 (]: 1 of 3 START sql view model olist_analytics.stg_customers ...................... [RUN]
[0m20:41:15.992001 [info ] [Thread-2 (]: 2 of 3 START sql view model olist_analytics.stg_orders ......................... [RUN]
[0m20:41:15.992306 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_olist_data_olist_analytics, now model.temp_olist_project.stg_customers)
[0m20:41:15.992577 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.temp_olist_project.stg_orders'
[0m20:41:15.992772 [debug] [Thread-1 (]: Began compiling node model.temp_olist_project.stg_customers
[0m20:41:15.992948 [debug] [Thread-2 (]: Began compiling node model.temp_olist_project.stg_orders
[0m20:41:15.997365 [debug] [Thread-1 (]: Writing injected SQL for node "model.temp_olist_project.stg_customers"
[0m20:41:15.998979 [debug] [Thread-2 (]: Writing injected SQL for node "model.temp_olist_project.stg_orders"
[0m20:41:15.999452 [debug] [Thread-1 (]: Began executing node model.temp_olist_project.stg_customers
[0m20:41:15.999639 [debug] [Thread-2 (]: Began executing node model.temp_olist_project.stg_orders
[0m20:41:16.017980 [debug] [Thread-1 (]: Writing runtime sql for node "model.temp_olist_project.stg_customers"
[0m20:41:16.020238 [debug] [Thread-2 (]: Writing runtime sql for node "model.temp_olist_project.stg_orders"
[0m20:41:16.020747 [debug] [Thread-1 (]: Using postgres connection "model.temp_olist_project.stg_customers"
[0m20:41:16.020948 [debug] [Thread-2 (]: Using postgres connection "model.temp_olist_project.stg_orders"
[0m20:41:16.021123 [debug] [Thread-1 (]: On model.temp_olist_project.stg_customers: BEGIN
[0m20:41:16.021294 [debug] [Thread-2 (]: On model.temp_olist_project.stg_orders: BEGIN
[0m20:41:16.021455 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:41:16.021602 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m20:41:16.029813 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m20:41:16.030033 [debug] [Thread-2 (]: SQL status: BEGIN in 0.008 seconds
[0m20:41:16.030255 [debug] [Thread-1 (]: Using postgres connection "model.temp_olist_project.stg_customers"
[0m20:41:16.030434 [debug] [Thread-2 (]: Using postgres connection "model.temp_olist_project.stg_orders"
[0m20:41:16.030621 [debug] [Thread-1 (]: On model.temp_olist_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.0b3", "profile_name": "temp_olist_project", "target_name": "dev", "node_id": "model.temp_olist_project.stg_customers"} */

  create view "olist_data"."olist_analytics"."stg_customers__dbt_tmp"
    
    
  as (
    -- models/staging/stg_customers.sql
WITH raw_customers AS (
    SELECT * FROM "olist_data"."olist_analytics"."olist_customers_dataset"
)
SELECT
    customer_id,
    customer_unique_id,
    customer_zip_code_prefix,
    customer_city,
    customer_state
FROM raw_customers
  );
[0m20:41:16.030826 [debug] [Thread-2 (]: On model.temp_olist_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.0b3", "profile_name": "temp_olist_project", "target_name": "dev", "node_id": "model.temp_olist_project.stg_orders"} */

  create view "olist_data"."olist_analytics"."stg_orders__dbt_tmp"
    
    
  as (
    -- models/staging/stg_orders.sql
WITH raw_orders AS (
    SELECT * FROM "olist_data"."olist_analytics"."olist_orders_dataset"
)
SELECT
    order_id,
    customer_id,
    order_purchase_timestamp,
    order_delivered_customer_date::date AS order_delivered_customer_date,
    order_estimated_delivery_date::date AS order_estimated_delivery_date,
    DATE_PART('day', order_estimated_delivery_date::date - order_delivered_customer_date::date) AS delivery_delay
FROM raw_orders
WHERE order_status = 'delivered'
  );
[0m20:41:16.032046 [debug] [Thread-2 (]: Postgres adapter: Postgres error: function date_part(unknown, integer) does not exist
LINE 17:     DATE_PART('day', order_estimated_delivery_date::date - o...
             ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[0m20:41:16.032232 [debug] [Thread-2 (]: On model.temp_olist_project.stg_orders: ROLLBACK
[0m20:41:16.032584 [debug] [Thread-2 (]: On model.temp_olist_project.stg_orders: Close
[0m20:41:16.034870 [debug] [Thread-2 (]: Database Error in model stg_orders (models/staging/stg_orders.sql)
  function date_part(unknown, integer) does not exist
  LINE 17:     DATE_PART('day', order_estimated_delivery_date::date - o...
               ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target/run/temp_olist_project/models/staging/stg_orders.sql
[0m20:41:16.035096 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m20:41:16.039101 [debug] [Thread-1 (]: Using postgres connection "model.temp_olist_project.stg_customers"
[0m20:41:16.039323 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4b0074a2-7bfc-40b0-a427-fdbbc603cc33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b43150>]}
[0m20:41:16.039495 [debug] [Thread-1 (]: On model.temp_olist_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.0b3", "profile_name": "temp_olist_project", "target_name": "dev", "node_id": "model.temp_olist_project.stg_customers"} */
alter table "olist_data"."olist_analytics"."stg_customers" rename to "stg_customers__dbt_backup"
[0m20:41:16.039815 [error] [Thread-2 (]: 2 of 3 ERROR creating sql view model olist_analytics.stg_orders ................ [[31mERROR[0m in 0.04s]
[0m20:41:16.040131 [debug] [Thread-2 (]: Finished running node model.temp_olist_project.stg_orders
[0m20:41:16.040352 [debug] [Thread-7 (]: Marking all children of 'model.temp_olist_project.stg_orders' to be skipped because of status 'error'.  Reason: Database Error in model stg_orders (models/staging/stg_orders.sql)
  function date_part(unknown, integer) does not exist
  LINE 17:     DATE_PART('day', order_estimated_delivery_date::date - o...
               ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target/run/temp_olist_project/models/staging/stg_orders.sql.
[0m20:41:16.040816 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:41:16.042187 [debug] [Thread-1 (]: Using postgres connection "model.temp_olist_project.stg_customers"
[0m20:41:16.042348 [debug] [Thread-1 (]: On model.temp_olist_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.0b3", "profile_name": "temp_olist_project", "target_name": "dev", "node_id": "model.temp_olist_project.stg_customers"} */
alter table "olist_data"."olist_analytics"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m20:41:16.042942 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:41:16.050722 [debug] [Thread-1 (]: On model.temp_olist_project.stg_customers: COMMIT
[0m20:41:16.051023 [debug] [Thread-1 (]: Using postgres connection "model.temp_olist_project.stg_customers"
[0m20:41:16.051187 [debug] [Thread-1 (]: On model.temp_olist_project.stg_customers: COMMIT
[0m20:41:16.051871 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m20:41:16.054815 [debug] [Thread-1 (]: Applying DROP to: "olist_data"."olist_analytics"."stg_customers__dbt_backup"
[0m20:41:16.057013 [debug] [Thread-1 (]: Using postgres connection "model.temp_olist_project.stg_customers"
[0m20:41:16.057190 [debug] [Thread-1 (]: On model.temp_olist_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.0b3", "profile_name": "temp_olist_project", "target_name": "dev", "node_id": "model.temp_olist_project.stg_customers"} */
drop view if exists "olist_data"."olist_analytics"."stg_customers__dbt_backup" cascade
[0m20:41:16.059288 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m20:41:16.060344 [debug] [Thread-1 (]: On model.temp_olist_project.stg_customers: Close
[0m20:41:16.060638 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4b0074a2-7bfc-40b0-a427-fdbbc603cc33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105be5750>]}
[0m20:41:16.060937 [info ] [Thread-1 (]: 1 of 3 OK created sql view model olist_analytics.stg_customers ................. [[32mCREATE VIEW[0m in 0.07s]
[0m20:41:16.061194 [debug] [Thread-1 (]: Finished running node model.temp_olist_project.stg_customers
[0m20:41:16.061496 [debug] [Thread-4 (]: Began running node model.temp_olist_project.customer_metrics
[0m20:41:16.061773 [info ] [Thread-4 (]: 3 of 3 SKIP relation olist_analytics.customer_metrics .......................... [[33mSKIP[0m]
[0m20:41:16.062021 [debug] [Thread-4 (]: Finished running node model.temp_olist_project.customer_metrics
[0m20:41:16.062546 [debug] [MainThread]: Using postgres connection "master"
[0m20:41:16.062712 [debug] [MainThread]: On master: BEGIN
[0m20:41:16.062846 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:41:16.071341 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m20:41:16.071609 [debug] [MainThread]: On master: COMMIT
[0m20:41:16.071742 [debug] [MainThread]: Using postgres connection "master"
[0m20:41:16.071868 [debug] [MainThread]: On master: COMMIT
[0m20:41:16.072129 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:41:16.072272 [debug] [MainThread]: On master: Close
[0m20:41:16.072476 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:41:16.072599 [debug] [MainThread]: Connection 'model.temp_olist_project.stg_customers' was properly closed.
[0m20:41:16.072714 [debug] [MainThread]: Connection 'model.temp_olist_project.stg_orders' was properly closed.
[0m20:41:16.072886 [info ] [MainThread]: 
[0m20:41:16.073042 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 0.18 seconds (0.18s).
[0m20:41:16.073429 [debug] [MainThread]: Command end result
[0m20:41:16.087734 [info ] [MainThread]: 
[0m20:41:16.088014 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successs, and 0 warnings:[0m
[0m20:41:16.088173 [info ] [MainThread]: 
[0m20:41:16.088357 [error] [MainThread]:   Database Error in model stg_orders (models/staging/stg_orders.sql)
  function date_part(unknown, integer) does not exist
  LINE 17:     DATE_PART('day', order_estimated_delivery_date::date - o...
               ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target/run/temp_olist_project/models/staging/stg_orders.sql
[0m20:41:16.088510 [info ] [MainThread]: 
[0m20:41:16.088658 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=1 TOTAL=3
[0m20:41:16.089607 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.45091736, "process_user_time": 0.876735, "process_kernel_time": 0.138723, "process_mem_max_rss": "120832000", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m20:41:16.089973 [debug] [MainThread]: Command `dbt run` failed at 20:41:16.089921 after 0.45 seconds
[0m20:41:16.090233 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10056bf50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104412490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104411f90>]}
[0m20:41:16.090430 [debug] [MainThread]: Flushing usage events
[0m20:41:17.375152 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:42:07.950581 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106663650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066d1c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066d25d0>]}


============================== 20:42:07.952943 | c3f05ae6-cf64-49a6-8347-d8c34cd227cd ==============================
[0m20:42:07.952943 [info ] [MainThread]: Running with dbt=1.9.0-b3
[0m20:42:07.953276 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/sushmitha/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/sushmitha/Documents/projects/olist_dbt_project/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m20:42:08.025851 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c3f05ae6-cf64-49a6-8347-d8c34cd227cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066b4b90>]}
[0m20:42:08.049180 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c3f05ae6-cf64-49a6-8347-d8c34cd227cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066d0890>]}
[0m20:42:08.049598 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m20:42:08.057602 [debug] [MainThread]: checksum: 5f4fde221ca8627174a0341efc73099aaec05b8546408ceed6f59b1ec0755115, vars: {}, profile: , target: , version: 1.9.0b3
[0m20:42:08.112716 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:42:08.113104 [debug] [MainThread]: Partial parsing: updated file: temp_olist_project://models/staging/stg_orders.sql
[0m20:42:08.282900 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.temp_olist_project.example
[0m20:42:08.289421 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c3f05ae6-cf64-49a6-8347-d8c34cd227cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10737ce90>]}
[0m20:42:08.336097 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c3f05ae6-cf64-49a6-8347-d8c34cd227cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10769ec90>]}
[0m20:42:08.336395 [info ] [MainThread]: Found 3 models, 3 data tests, 11 sources, 428 macros
[0m20:42:08.336584 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c3f05ae6-cf64-49a6-8347-d8c34cd227cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073d50d0>]}
[0m20:42:08.337536 [info ] [MainThread]: 
[0m20:42:08.337714 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:42:08.337846 [info ] [MainThread]: 
[0m20:42:08.338089 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:42:08.339887 [debug] [ThreadPool]: Acquiring new postgres connection 'list_olist_data'
[0m20:42:08.364868 [debug] [ThreadPool]: Using postgres connection "list_olist_data"
[0m20:42:08.365104 [debug] [ThreadPool]: On list_olist_data: /* {"app": "dbt", "dbt_version": "1.9.0b3", "profile_name": "temp_olist_project", "target_name": "dev", "connection_name": "list_olist_data"} */

    select distinct nspname from pg_namespace
  
[0m20:42:08.365249 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:42:08.391285 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.026 seconds
[0m20:42:08.392100 [debug] [ThreadPool]: On list_olist_data: Close
[0m20:42:08.392766 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_olist_data, now list_olist_data_olist_analytics)
[0m20:42:08.395945 [debug] [ThreadPool]: Using postgres connection "list_olist_data_olist_analytics"
[0m20:42:08.396154 [debug] [ThreadPool]: On list_olist_data_olist_analytics: BEGIN
[0m20:42:08.396310 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:42:08.406292 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m20:42:08.406463 [debug] [ThreadPool]: Using postgres connection "list_olist_data_olist_analytics"
[0m20:42:08.406628 [debug] [ThreadPool]: On list_olist_data_olist_analytics: /* {"app": "dbt", "dbt_version": "1.9.0b3", "profile_name": "temp_olist_project", "target_name": "dev", "connection_name": "list_olist_data_olist_analytics"} */
select
      'olist_data' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'olist_analytics'
    union all
    select
      'olist_data' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'olist_analytics'
    union all
    select
      'olist_data' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'olist_analytics'
  
[0m20:42:08.413166 [debug] [ThreadPool]: SQL status: SELECT 12 in 0.006 seconds
[0m20:42:08.414030 [debug] [ThreadPool]: On list_olist_data_olist_analytics: ROLLBACK
[0m20:42:08.414407 [debug] [ThreadPool]: On list_olist_data_olist_analytics: Close
[0m20:42:08.417727 [debug] [MainThread]: Using postgres connection "master"
[0m20:42:08.417907 [debug] [MainThread]: On master: BEGIN
[0m20:42:08.418048 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:42:08.428018 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m20:42:08.428180 [debug] [MainThread]: Using postgres connection "master"
[0m20:42:08.428411 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0b3", "profile_name": "temp_olist_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:42:08.441068 [debug] [MainThread]: SQL status: SELECT 1 in 0.012 seconds
[0m20:42:08.441848 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c3f05ae6-cf64-49a6-8347-d8c34cd227cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a28510>]}
[0m20:42:08.442108 [debug] [MainThread]: On master: ROLLBACK
[0m20:42:08.442407 [debug] [MainThread]: Using postgres connection "master"
[0m20:42:08.442565 [debug] [MainThread]: On master: BEGIN
[0m20:42:08.442947 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m20:42:08.443114 [debug] [MainThread]: On master: COMMIT
[0m20:42:08.443263 [debug] [MainThread]: Using postgres connection "master"
[0m20:42:08.443407 [debug] [MainThread]: On master: COMMIT
[0m20:42:08.443660 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:42:08.443827 [debug] [MainThread]: On master: Close
[0m20:42:08.445011 [debug] [Thread-1 (]: Began running node model.temp_olist_project.stg_customers
[0m20:42:08.445251 [debug] [Thread-2 (]: Began running node model.temp_olist_project.stg_orders
[0m20:42:08.445653 [info ] [Thread-1 (]: 1 of 3 START sql view model olist_analytics.stg_customers ...................... [RUN]
[0m20:42:08.445946 [info ] [Thread-2 (]: 2 of 3 START sql view model olist_analytics.stg_orders ......................... [RUN]
[0m20:42:08.446255 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_olist_data_olist_analytics, now model.temp_olist_project.stg_customers)
[0m20:42:08.446578 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.temp_olist_project.stg_orders'
[0m20:42:08.446800 [debug] [Thread-1 (]: Began compiling node model.temp_olist_project.stg_customers
[0m20:42:08.446998 [debug] [Thread-2 (]: Began compiling node model.temp_olist_project.stg_orders
[0m20:42:08.451407 [debug] [Thread-1 (]: Writing injected SQL for node "model.temp_olist_project.stg_customers"
[0m20:42:08.453031 [debug] [Thread-2 (]: Writing injected SQL for node "model.temp_olist_project.stg_orders"
[0m20:42:08.453611 [debug] [Thread-1 (]: Began executing node model.temp_olist_project.stg_customers
[0m20:42:08.453800 [debug] [Thread-2 (]: Began executing node model.temp_olist_project.stg_orders
[0m20:42:08.475548 [debug] [Thread-2 (]: Writing runtime sql for node "model.temp_olist_project.stg_orders"
[0m20:42:08.475838 [debug] [Thread-1 (]: Writing runtime sql for node "model.temp_olist_project.stg_customers"
[0m20:42:08.476351 [debug] [Thread-2 (]: Using postgres connection "model.temp_olist_project.stg_orders"
[0m20:42:08.476543 [debug] [Thread-1 (]: Using postgres connection "model.temp_olist_project.stg_customers"
[0m20:42:08.476719 [debug] [Thread-2 (]: On model.temp_olist_project.stg_orders: BEGIN
[0m20:42:08.476878 [debug] [Thread-1 (]: On model.temp_olist_project.stg_customers: BEGIN
[0m20:42:08.477029 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m20:42:08.477173 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:42:08.487360 [debug] [Thread-2 (]: SQL status: BEGIN in 0.010 seconds
[0m20:42:08.487590 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m20:42:08.487833 [debug] [Thread-2 (]: Using postgres connection "model.temp_olist_project.stg_orders"
[0m20:42:08.488009 [debug] [Thread-1 (]: Using postgres connection "model.temp_olist_project.stg_customers"
[0m20:42:08.488193 [debug] [Thread-2 (]: On model.temp_olist_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.0b3", "profile_name": "temp_olist_project", "target_name": "dev", "node_id": "model.temp_olist_project.stg_orders"} */

  create view "olist_data"."olist_analytics"."stg_orders__dbt_tmp"
    
    
  as (
    -- models/staging/stg_orders.sql
WITH raw_orders AS (
    SELECT * FROM "olist_data"."olist_analytics"."olist_orders_dataset"
)
SELECT
    order_id,
    customer_id,
    order_purchase_timestamp,
    order_delivered_customer_date::date AS order_delivered_customer_date,
    order_estimated_delivery_date::date AS order_estimated_delivery_date,
    DATE_PART('day', (order_estimated_delivery_date::date - order_delivered_customer_date::date)::interval) AS delivery_delay
FROM raw_orders
WHERE order_status = 'delivered'
  );
[0m20:42:08.488390 [debug] [Thread-1 (]: On model.temp_olist_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.0b3", "profile_name": "temp_olist_project", "target_name": "dev", "node_id": "model.temp_olist_project.stg_customers"} */

  create view "olist_data"."olist_analytics"."stg_customers__dbt_tmp"
    
    
  as (
    -- models/staging/stg_customers.sql
WITH raw_customers AS (
    SELECT * FROM "olist_data"."olist_analytics"."olist_customers_dataset"
)
SELECT
    customer_id,
    customer_unique_id,
    customer_zip_code_prefix,
    customer_city,
    customer_state
FROM raw_customers
  );
[0m20:42:08.489577 [debug] [Thread-2 (]: Postgres adapter: Postgres error: cannot cast type integer to interval
LINE 17: ..._date::date - order_delivered_customer_date::date)::interval...
                                                              ^

[0m20:42:08.489754 [debug] [Thread-2 (]: On model.temp_olist_project.stg_orders: ROLLBACK
[0m20:42:08.490055 [debug] [Thread-2 (]: On model.temp_olist_project.stg_orders: Close
[0m20:42:08.490871 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m20:42:08.494349 [debug] [Thread-1 (]: Using postgres connection "model.temp_olist_project.stg_customers"
[0m20:42:08.494725 [debug] [Thread-1 (]: On model.temp_olist_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.0b3", "profile_name": "temp_olist_project", "target_name": "dev", "node_id": "model.temp_olist_project.stg_customers"} */
alter table "olist_data"."olist_analytics"."stg_customers" rename to "stg_customers__dbt_backup"
[0m20:42:08.495593 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:42:08.496576 [debug] [Thread-2 (]: Database Error in model stg_orders (models/staging/stg_orders.sql)
  cannot cast type integer to interval
  LINE 17: ..._date::date - order_delivered_customer_date::date)::interval...
                                                                ^
  compiled code at target/run/temp_olist_project/models/staging/stg_orders.sql
[0m20:42:08.498272 [debug] [Thread-1 (]: Using postgres connection "model.temp_olist_project.stg_customers"
[0m20:42:08.499218 [debug] [Thread-1 (]: On model.temp_olist_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.0b3", "profile_name": "temp_olist_project", "target_name": "dev", "node_id": "model.temp_olist_project.stg_customers"} */
alter table "olist_data"."olist_analytics"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m20:42:08.499443 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c3f05ae6-cf64-49a6-8347-d8c34cd227cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079b6b50>]}
[0m20:42:08.499823 [error] [Thread-2 (]: 2 of 3 ERROR creating sql view model olist_analytics.stg_orders ................ [[31mERROR[0m in 0.05s]
[0m20:42:08.500035 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:42:08.500332 [debug] [Thread-2 (]: Finished running node model.temp_olist_project.stg_orders
[0m20:42:08.508585 [debug] [Thread-1 (]: On model.temp_olist_project.stg_customers: COMMIT
[0m20:42:08.508912 [debug] [Thread-7 (]: Marking all children of 'model.temp_olist_project.stg_orders' to be skipped because of status 'error'.  Reason: Database Error in model stg_orders (models/staging/stg_orders.sql)
  cannot cast type integer to interval
  LINE 17: ..._date::date - order_delivered_customer_date::date)::interval...
                                                                ^
  compiled code at target/run/temp_olist_project/models/staging/stg_orders.sql.
[0m20:42:08.509155 [debug] [Thread-1 (]: Using postgres connection "model.temp_olist_project.stg_customers"
[0m20:42:08.509692 [debug] [Thread-1 (]: On model.temp_olist_project.stg_customers: COMMIT
[0m20:42:08.511012 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m20:42:08.514356 [debug] [Thread-1 (]: Applying DROP to: "olist_data"."olist_analytics"."stg_customers__dbt_backup"
[0m20:42:08.516810 [debug] [Thread-1 (]: Using postgres connection "model.temp_olist_project.stg_customers"
[0m20:42:08.517076 [debug] [Thread-1 (]: On model.temp_olist_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.0b3", "profile_name": "temp_olist_project", "target_name": "dev", "node_id": "model.temp_olist_project.stg_customers"} */
drop view if exists "olist_data"."olist_analytics"."stg_customers__dbt_backup" cascade
[0m20:42:08.529912 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.013 seconds
[0m20:42:08.531422 [debug] [Thread-1 (]: On model.temp_olist_project.stg_customers: Close
[0m20:42:08.531773 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c3f05ae6-cf64-49a6-8347-d8c34cd227cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a285d0>]}
[0m20:42:08.532121 [info ] [Thread-1 (]: 1 of 3 OK created sql view model olist_analytics.stg_customers ................. [[32mCREATE VIEW[0m in 0.09s]
[0m20:42:08.532406 [debug] [Thread-1 (]: Finished running node model.temp_olist_project.stg_customers
[0m20:42:08.532818 [debug] [Thread-4 (]: Began running node model.temp_olist_project.customer_metrics
[0m20:42:08.533077 [info ] [Thread-4 (]: 3 of 3 SKIP relation olist_analytics.customer_metrics .......................... [[33mSKIP[0m]
[0m20:42:08.533330 [debug] [Thread-4 (]: Finished running node model.temp_olist_project.customer_metrics
[0m20:42:08.534003 [debug] [MainThread]: Using postgres connection "master"
[0m20:42:08.534210 [debug] [MainThread]: On master: BEGIN
[0m20:42:08.534362 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:42:08.541610 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m20:42:08.541810 [debug] [MainThread]: On master: COMMIT
[0m20:42:08.541952 [debug] [MainThread]: Using postgres connection "master"
[0m20:42:08.542086 [debug] [MainThread]: On master: COMMIT
[0m20:42:08.542315 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:42:08.542460 [debug] [MainThread]: On master: Close
[0m20:42:08.542669 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:42:08.542815 [debug] [MainThread]: Connection 'model.temp_olist_project.stg_customers' was properly closed.
[0m20:42:08.542947 [debug] [MainThread]: Connection 'model.temp_olist_project.stg_orders' was properly closed.
[0m20:42:08.543139 [info ] [MainThread]: 
[0m20:42:08.543301 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 0.21 seconds (0.21s).
[0m20:42:08.543699 [debug] [MainThread]: Command end result
[0m20:42:08.594171 [info ] [MainThread]: 
[0m20:42:08.594460 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successs, and 0 warnings:[0m
[0m20:42:08.594630 [info ] [MainThread]: 
[0m20:42:08.594817 [error] [MainThread]:   Database Error in model stg_orders (models/staging/stg_orders.sql)
  cannot cast type integer to interval
  LINE 17: ..._date::date - order_delivered_customer_date::date)::interval...
                                                                ^
  compiled code at target/run/temp_olist_project/models/staging/stg_orders.sql
[0m20:42:08.595188 [info ] [MainThread]: 
[0m20:42:08.595351 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=1 TOTAL=3
[0m20:42:08.596622 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.67650086, "process_user_time": 1.068485, "process_kernel_time": 0.149515, "process_mem_max_rss": "129728512", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m20:42:08.596906 [debug] [MainThread]: Command `dbt run` failed at 20:42:08.596863 after 0.68 seconds
[0m20:42:08.597101 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074ce6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074ccad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074cdf10>]}
[0m20:42:08.597276 [debug] [MainThread]: Flushing usage events
[0m20:42:09.996398 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:42:41.794589 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10913f2d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109190d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1091ae110>]}


============================== 20:42:41.797423 | 6b75a7de-69e0-4c3e-96a6-9633d1915d42 ==============================
[0m20:42:41.797423 [info ] [MainThread]: Running with dbt=1.9.0-b3
[0m20:42:41.797749 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/sushmitha/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/sushmitha/Documents/projects/olist_dbt_project/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m20:42:41.887025 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6b75a7de-69e0-4c3e-96a6-9633d1915d42', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10913d110>]}
[0m20:42:41.910613 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6b75a7de-69e0-4c3e-96a6-9633d1915d42', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ee91d0>]}
[0m20:42:41.911225 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m20:42:41.921785 [debug] [MainThread]: checksum: 5f4fde221ca8627174a0341efc73099aaec05b8546408ceed6f59b1ec0755115, vars: {}, profile: , target: , version: 1.9.0b3
[0m20:42:41.988461 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:42:41.988853 [debug] [MainThread]: Partial parsing: updated file: temp_olist_project://models/staging/stg_orders.sql
[0m20:42:42.158137 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.temp_olist_project.example
[0m20:42:42.163919 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6b75a7de-69e0-4c3e-96a6-9633d1915d42', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1095b79d0>]}
[0m20:42:42.214425 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6b75a7de-69e0-4c3e-96a6-9633d1915d42', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a63f050>]}
[0m20:42:42.214736 [info ] [MainThread]: Found 3 models, 3 data tests, 11 sources, 428 macros
[0m20:42:42.214904 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6b75a7de-69e0-4c3e-96a6-9633d1915d42', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a3cd550>]}
[0m20:42:42.215850 [info ] [MainThread]: 
[0m20:42:42.216044 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:42:42.216178 [info ] [MainThread]: 
[0m20:42:42.216406 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:42:42.218246 [debug] [ThreadPool]: Acquiring new postgres connection 'list_olist_data'
[0m20:42:42.246006 [debug] [ThreadPool]: Using postgres connection "list_olist_data"
[0m20:42:42.246235 [debug] [ThreadPool]: On list_olist_data: /* {"app": "dbt", "dbt_version": "1.9.0b3", "profile_name": "temp_olist_project", "target_name": "dev", "connection_name": "list_olist_data"} */

    select distinct nspname from pg_namespace
  
[0m20:42:42.246374 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:42:42.270638 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.024 seconds
[0m20:42:42.271455 [debug] [ThreadPool]: On list_olist_data: Close
[0m20:42:42.272085 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_olist_data, now list_olist_data_olist_analytics)
[0m20:42:42.274902 [debug] [ThreadPool]: Using postgres connection "list_olist_data_olist_analytics"
[0m20:42:42.275062 [debug] [ThreadPool]: On list_olist_data_olist_analytics: BEGIN
[0m20:42:42.275187 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:42:42.283756 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m20:42:42.283899 [debug] [ThreadPool]: Using postgres connection "list_olist_data_olist_analytics"
[0m20:42:42.284046 [debug] [ThreadPool]: On list_olist_data_olist_analytics: /* {"app": "dbt", "dbt_version": "1.9.0b3", "profile_name": "temp_olist_project", "target_name": "dev", "connection_name": "list_olist_data_olist_analytics"} */
select
      'olist_data' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'olist_analytics'
    union all
    select
      'olist_data' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'olist_analytics'
    union all
    select
      'olist_data' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'olist_analytics'
  
[0m20:42:42.291173 [debug] [ThreadPool]: SQL status: SELECT 12 in 0.007 seconds
[0m20:42:42.291926 [debug] [ThreadPool]: On list_olist_data_olist_analytics: ROLLBACK
[0m20:42:42.292274 [debug] [ThreadPool]: On list_olist_data_olist_analytics: Close
[0m20:42:42.295297 [debug] [MainThread]: Using postgres connection "master"
[0m20:42:42.295471 [debug] [MainThread]: On master: BEGIN
[0m20:42:42.295605 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:42:42.305468 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m20:42:42.305641 [debug] [MainThread]: Using postgres connection "master"
[0m20:42:42.305872 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0b3", "profile_name": "temp_olist_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:42:42.318458 [debug] [MainThread]: SQL status: SELECT 1 in 0.012 seconds
[0m20:42:42.319248 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6b75a7de-69e0-4c3e-96a6-9633d1915d42', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a059510>]}
[0m20:42:42.319496 [debug] [MainThread]: On master: ROLLBACK
[0m20:42:42.319806 [debug] [MainThread]: Using postgres connection "master"
[0m20:42:42.319964 [debug] [MainThread]: On master: BEGIN
[0m20:42:42.320359 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m20:42:42.320526 [debug] [MainThread]: On master: COMMIT
[0m20:42:42.320673 [debug] [MainThread]: Using postgres connection "master"
[0m20:42:42.320818 [debug] [MainThread]: On master: COMMIT
[0m20:42:42.321077 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:42:42.321234 [debug] [MainThread]: On master: Close
[0m20:42:42.322654 [debug] [Thread-1 (]: Began running node model.temp_olist_project.stg_customers
[0m20:42:42.322873 [debug] [Thread-2 (]: Began running node model.temp_olist_project.stg_orders
[0m20:42:42.323311 [info ] [Thread-1 (]: 1 of 3 START sql view model olist_analytics.stg_customers ...................... [RUN]
[0m20:42:42.323617 [info ] [Thread-2 (]: 2 of 3 START sql view model olist_analytics.stg_orders ......................... [RUN]
[0m20:42:42.323904 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_olist_data_olist_analytics, now model.temp_olist_project.stg_customers)
[0m20:42:42.324183 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.temp_olist_project.stg_orders'
[0m20:42:42.324400 [debug] [Thread-1 (]: Began compiling node model.temp_olist_project.stg_customers
[0m20:42:42.324595 [debug] [Thread-2 (]: Began compiling node model.temp_olist_project.stg_orders
[0m20:42:42.328929 [debug] [Thread-1 (]: Writing injected SQL for node "model.temp_olist_project.stg_customers"
[0m20:42:42.330492 [debug] [Thread-2 (]: Writing injected SQL for node "model.temp_olist_project.stg_orders"
[0m20:42:42.331017 [debug] [Thread-1 (]: Began executing node model.temp_olist_project.stg_customers
[0m20:42:42.331207 [debug] [Thread-2 (]: Began executing node model.temp_olist_project.stg_orders
[0m20:42:42.349422 [debug] [Thread-1 (]: Writing runtime sql for node "model.temp_olist_project.stg_customers"
[0m20:42:42.351397 [debug] [Thread-2 (]: Writing runtime sql for node "model.temp_olist_project.stg_orders"
[0m20:42:42.351900 [debug] [Thread-1 (]: Using postgres connection "model.temp_olist_project.stg_customers"
[0m20:42:42.352142 [debug] [Thread-2 (]: Using postgres connection "model.temp_olist_project.stg_orders"
[0m20:42:42.352310 [debug] [Thread-1 (]: On model.temp_olist_project.stg_customers: BEGIN
[0m20:42:42.352504 [debug] [Thread-2 (]: On model.temp_olist_project.stg_orders: BEGIN
[0m20:42:42.352698 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:42:42.352853 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m20:42:42.360200 [debug] [Thread-2 (]: SQL status: BEGIN in 0.007 seconds
[0m20:42:42.360408 [debug] [Thread-2 (]: Using postgres connection "model.temp_olist_project.stg_orders"
[0m20:42:42.360585 [debug] [Thread-2 (]: On model.temp_olist_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.0b3", "profile_name": "temp_olist_project", "target_name": "dev", "node_id": "model.temp_olist_project.stg_orders"} */

  create view "olist_data"."olist_analytics"."stg_orders__dbt_tmp"
    
    
  as (
    -- models/staging/stg_orders.sql
WITH raw_orders AS (
    SELECT * FROM "olist_data"."olist_analytics"."olist_orders_dataset"
)
SELECT
    order_id,
    customer_id,
    order_purchase_timestamp,
    order_delivered_customer_date::date AS order_delivered_customer_date,
    order_estimated_delivery_date::date AS order_estimated_delivery_date,
    (order_estimated_delivery_date::date - order_delivered_customer_date::date) AS delivery_delay
FROM raw_orders
WHERE order_status = 'delivered'
  );
[0m20:42:42.364068 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m20:42:42.367597 [debug] [Thread-2 (]: Using postgres connection "model.temp_olist_project.stg_orders"
[0m20:42:42.367808 [debug] [Thread-2 (]: On model.temp_olist_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.0b3", "profile_name": "temp_olist_project", "target_name": "dev", "node_id": "model.temp_olist_project.stg_orders"} */
alter table "olist_data"."olist_analytics"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m20:42:42.368482 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:42:42.375648 [debug] [Thread-2 (]: On model.temp_olist_project.stg_orders: COMMIT
[0m20:42:42.375899 [debug] [Thread-2 (]: Using postgres connection "model.temp_olist_project.stg_orders"
[0m20:42:42.376065 [debug] [Thread-2 (]: On model.temp_olist_project.stg_orders: COMMIT
[0m20:42:42.376253 [debug] [Thread-1 (]: SQL status: BEGIN in 0.024 seconds
[0m20:42:42.376447 [debug] [Thread-1 (]: Using postgres connection "model.temp_olist_project.stg_customers"
[0m20:42:42.376622 [debug] [Thread-1 (]: On model.temp_olist_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.0b3", "profile_name": "temp_olist_project", "target_name": "dev", "node_id": "model.temp_olist_project.stg_customers"} */

  create view "olist_data"."olist_analytics"."stg_customers__dbt_tmp"
    
    
  as (
    -- models/staging/stg_customers.sql
WITH raw_customers AS (
    SELECT * FROM "olist_data"."olist_analytics"."olist_customers_dataset"
)
SELECT
    customer_id,
    customer_unique_id,
    customer_zip_code_prefix,
    customer_city,
    customer_state
FROM raw_customers
  );
[0m20:42:42.376898 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m20:42:42.379813 [debug] [Thread-2 (]: Applying DROP to: "olist_data"."olist_analytics"."stg_orders__dbt_backup"
[0m20:42:42.379981 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m20:42:42.382381 [debug] [Thread-2 (]: Using postgres connection "model.temp_olist_project.stg_orders"
[0m20:42:42.384087 [debug] [Thread-1 (]: Using postgres connection "model.temp_olist_project.stg_customers"
[0m20:42:42.384279 [debug] [Thread-2 (]: On model.temp_olist_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.0b3", "profile_name": "temp_olist_project", "target_name": "dev", "node_id": "model.temp_olist_project.stg_orders"} */
drop view if exists "olist_data"."olist_analytics"."stg_orders__dbt_backup" cascade
[0m20:42:42.384472 [debug] [Thread-1 (]: On model.temp_olist_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.0b3", "profile_name": "temp_olist_project", "target_name": "dev", "node_id": "model.temp_olist_project.stg_customers"} */
alter table "olist_data"."olist_analytics"."stg_customers" rename to "stg_customers__dbt_backup"
[0m20:42:42.384960 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.000 seconds
[0m20:42:42.386022 [debug] [Thread-2 (]: On model.temp_olist_project.stg_orders: Close
[0m20:42:42.386194 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m20:42:42.388142 [debug] [Thread-1 (]: Using postgres connection "model.temp_olist_project.stg_customers"
[0m20:42:42.388322 [debug] [Thread-1 (]: On model.temp_olist_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.0b3", "profile_name": "temp_olist_project", "target_name": "dev", "node_id": "model.temp_olist_project.stg_customers"} */
alter table "olist_data"."olist_analytics"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m20:42:42.388677 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6b75a7de-69e0-4c3e-96a6-9633d1915d42', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c1a7050>]}
[0m20:42:42.388972 [info ] [Thread-2 (]: 2 of 3 OK created sql view model olist_analytics.stg_orders .................... [[32mCREATE VIEW[0m in 0.06s]
[0m20:42:42.389223 [debug] [Thread-2 (]: Finished running node model.temp_olist_project.stg_orders
[0m20:42:42.390381 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m20:42:42.392112 [debug] [Thread-1 (]: On model.temp_olist_project.stg_customers: COMMIT
[0m20:42:42.392286 [debug] [Thread-1 (]: Using postgres connection "model.temp_olist_project.stg_customers"
[0m20:42:42.392437 [debug] [Thread-1 (]: On model.temp_olist_project.stg_customers: COMMIT
[0m20:42:42.392945 [debug] [Thread-1 (]: SQL status: COMMIT in 0.000 seconds
[0m20:42:42.394114 [debug] [Thread-1 (]: Applying DROP to: "olist_data"."olist_analytics"."stg_customers__dbt_backup"
[0m20:42:42.394428 [debug] [Thread-1 (]: Using postgres connection "model.temp_olist_project.stg_customers"
[0m20:42:42.394590 [debug] [Thread-1 (]: On model.temp_olist_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.0b3", "profile_name": "temp_olist_project", "target_name": "dev", "node_id": "model.temp_olist_project.stg_customers"} */
drop view if exists "olist_data"."olist_analytics"."stg_customers__dbt_backup" cascade
[0m20:42:42.395701 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m20:42:42.396281 [debug] [Thread-1 (]: On model.temp_olist_project.stg_customers: Close
[0m20:42:42.396547 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6b75a7de-69e0-4c3e-96a6-9633d1915d42', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c1644d0>]}
[0m20:42:42.396836 [info ] [Thread-1 (]: 1 of 3 OK created sql view model olist_analytics.stg_customers ................. [[32mCREATE VIEW[0m in 0.07s]
[0m20:42:42.397086 [debug] [Thread-1 (]: Finished running node model.temp_olist_project.stg_customers
[0m20:42:42.397428 [debug] [Thread-4 (]: Began running node model.temp_olist_project.customer_metrics
[0m20:42:42.397703 [info ] [Thread-4 (]: 3 of 3 START sql view model olist_analytics.customer_metrics ................... [RUN]
[0m20:42:42.398024 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.temp_olist_project.customer_metrics'
[0m20:42:42.398218 [debug] [Thread-4 (]: Began compiling node model.temp_olist_project.customer_metrics
[0m20:42:42.400490 [debug] [Thread-4 (]: Writing injected SQL for node "model.temp_olist_project.customer_metrics"
[0m20:42:42.401016 [debug] [Thread-4 (]: Began executing node model.temp_olist_project.customer_metrics
[0m20:42:42.402865 [debug] [Thread-4 (]: Writing runtime sql for node "model.temp_olist_project.customer_metrics"
[0m20:42:42.403233 [debug] [Thread-4 (]: Using postgres connection "model.temp_olist_project.customer_metrics"
[0m20:42:42.403401 [debug] [Thread-4 (]: On model.temp_olist_project.customer_metrics: BEGIN
[0m20:42:42.403547 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m20:42:42.410037 [debug] [Thread-4 (]: SQL status: BEGIN in 0.006 seconds
[0m20:42:42.410217 [debug] [Thread-4 (]: Using postgres connection "model.temp_olist_project.customer_metrics"
[0m20:42:42.410399 [debug] [Thread-4 (]: On model.temp_olist_project.customer_metrics: /* {"app": "dbt", "dbt_version": "1.9.0b3", "profile_name": "temp_olist_project", "target_name": "dev", "node_id": "model.temp_olist_project.customer_metrics"} */

  create view "olist_data"."olist_analytics"."customer_metrics__dbt_tmp"
    
    
  as (
    -- models/transformations/customer_metrics.sql
WITH customer_orders AS (
    SELECT
        o.customer_id,
        COUNT(o.order_id) AS total_orders,
        SUM(p.payment_value) AS total_spent
    FROM "olist_data"."olist_analytics"."stg_orders" o
    JOIN "olist_data"."olist_analytics"."olist_order_payments_dataset" p ON o.order_id = p.order_id
    GROUP BY o.customer_id
)
SELECT
    c.customer_id,
    c.customer_unique_id,
    c.customer_city,
    c.customer_state,
    co.total_orders,
    co.total_spent
FROM "olist_data"."olist_analytics"."stg_customers" c
LEFT JOIN customer_orders co ON c.customer_id = co.customer_id
  );
[0m20:42:42.430731 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.020 seconds
[0m20:42:42.432632 [debug] [Thread-4 (]: Using postgres connection "model.temp_olist_project.customer_metrics"
[0m20:42:42.432849 [debug] [Thread-4 (]: On model.temp_olist_project.customer_metrics: /* {"app": "dbt", "dbt_version": "1.9.0b3", "profile_name": "temp_olist_project", "target_name": "dev", "node_id": "model.temp_olist_project.customer_metrics"} */
alter table "olist_data"."olist_analytics"."customer_metrics__dbt_tmp" rename to "customer_metrics"
[0m20:42:42.437098 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m20:42:42.437989 [debug] [Thread-4 (]: On model.temp_olist_project.customer_metrics: COMMIT
[0m20:42:42.438178 [debug] [Thread-4 (]: Using postgres connection "model.temp_olist_project.customer_metrics"
[0m20:42:42.438348 [debug] [Thread-4 (]: On model.temp_olist_project.customer_metrics: COMMIT
[0m20:42:42.439127 [debug] [Thread-4 (]: SQL status: COMMIT in 0.001 seconds
[0m20:42:42.441590 [debug] [Thread-4 (]: Applying DROP to: "olist_data"."olist_analytics"."customer_metrics__dbt_backup"
[0m20:42:42.441970 [debug] [Thread-4 (]: Using postgres connection "model.temp_olist_project.customer_metrics"
[0m20:42:42.442161 [debug] [Thread-4 (]: On model.temp_olist_project.customer_metrics: /* {"app": "dbt", "dbt_version": "1.9.0b3", "profile_name": "temp_olist_project", "target_name": "dev", "node_id": "model.temp_olist_project.customer_metrics"} */
drop view if exists "olist_data"."olist_analytics"."customer_metrics__dbt_backup" cascade
[0m20:42:42.442577 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.000 seconds
[0m20:42:42.443244 [debug] [Thread-4 (]: On model.temp_olist_project.customer_metrics: Close
[0m20:42:42.443761 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6b75a7de-69e0-4c3e-96a6-9633d1915d42', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c2d12d0>]}
[0m20:42:42.444152 [info ] [Thread-4 (]: 3 of 3 OK created sql view model olist_analytics.customer_metrics .............. [[32mCREATE VIEW[0m in 0.05s]
[0m20:42:42.444465 [debug] [Thread-4 (]: Finished running node model.temp_olist_project.customer_metrics
[0m20:42:42.445122 [debug] [MainThread]: Using postgres connection "master"
[0m20:42:42.445280 [debug] [MainThread]: On master: BEGIN
[0m20:42:42.445418 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:42:42.456159 [debug] [MainThread]: SQL status: BEGIN in 0.011 seconds
[0m20:42:42.456620 [debug] [MainThread]: On master: COMMIT
[0m20:42:42.456777 [debug] [MainThread]: Using postgres connection "master"
[0m20:42:42.456920 [debug] [MainThread]: On master: COMMIT
[0m20:42:42.457221 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:42:42.457480 [debug] [MainThread]: On master: Close
[0m20:42:42.457778 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:42:42.457942 [debug] [MainThread]: Connection 'model.temp_olist_project.stg_customers' was properly closed.
[0m20:42:42.458105 [debug] [MainThread]: Connection 'model.temp_olist_project.stg_orders' was properly closed.
[0m20:42:42.458240 [debug] [MainThread]: Connection 'model.temp_olist_project.customer_metrics' was properly closed.
[0m20:42:42.458438 [info ] [MainThread]: 
[0m20:42:42.458619 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 0.24 seconds (0.24s).
[0m20:42:42.459080 [debug] [MainThread]: Command end result
[0m20:42:42.506048 [info ] [MainThread]: 
[0m20:42:42.506322 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:42:42.506473 [info ] [MainThread]: 
[0m20:42:42.506621 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m20:42:42.507976 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.7440328, "process_user_time": 1.084859, "process_kernel_time": 0.177145, "process_mem_max_rss": "126369792", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m20:42:42.508255 [debug] [MainThread]: Command `dbt run` succeeded at 20:42:42.508213 after 0.74 seconds
[0m20:42:42.508448 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10512cd10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10507fdd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10508ccd0>]}
[0m20:42:42.508626 [debug] [MainThread]: Flushing usage events
[0m20:42:45.087628 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:45:07.277781 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10617d690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061ea0d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061eaa10>]}


============================== 20:45:07.280935 | d061a3b5-ce59-41cd-b730-d4792e925daf ==============================
[0m20:45:07.280935 [info ] [MainThread]: Running with dbt=1.9.0-b3
[0m20:45:07.281301 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/sushmitha/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/sushmitha/Documents/projects/olist_dbt_project/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt docs generate', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:45:07.366056 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd061a3b5-ce59-41cd-b730-d4792e925daf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106669a10>]}
[0m20:45:07.389614 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd061a3b5-ce59-41cd-b730-d4792e925daf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104240ed0>]}
[0m20:45:07.390352 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m20:45:07.399888 [debug] [MainThread]: checksum: 5f4fde221ca8627174a0341efc73099aaec05b8546408ceed6f59b1ec0755115, vars: {}, profile: , target: , version: 1.9.0b3
[0m20:45:07.469856 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:45:07.470113 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:45:07.472672 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.temp_olist_project.example
[0m20:45:07.491997 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd061a3b5-ce59-41cd-b730-d4792e925daf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d5ed90>]}
[0m20:45:07.504289 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd061a3b5-ce59-41cd-b730-d4792e925daf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106785390>]}
[0m20:45:07.504590 [info ] [MainThread]: Found 3 models, 3 data tests, 11 sources, 428 macros
[0m20:45:07.504759 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd061a3b5-ce59-41cd-b730-d4792e925daf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10671be50>]}
[0m20:45:07.505725 [info ] [MainThread]: 
[0m20:45:07.505893 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:45:07.506024 [info ] [MainThread]: 
[0m20:45:07.506266 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:45:07.508010 [debug] [ThreadPool]: Acquiring new postgres connection 'list_olist_data_olist_analytics'
[0m20:45:07.539215 [debug] [ThreadPool]: Using postgres connection "list_olist_data_olist_analytics"
[0m20:45:07.539451 [debug] [ThreadPool]: On list_olist_data_olist_analytics: BEGIN
[0m20:45:07.539603 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:45:07.568803 [debug] [ThreadPool]: SQL status: BEGIN in 0.029 seconds
[0m20:45:07.569081 [debug] [ThreadPool]: Using postgres connection "list_olist_data_olist_analytics"
[0m20:45:07.569248 [debug] [ThreadPool]: On list_olist_data_olist_analytics: /* {"app": "dbt", "dbt_version": "1.9.0b3", "profile_name": "temp_olist_project", "target_name": "dev", "connection_name": "list_olist_data_olist_analytics"} */
select
      'olist_data' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'olist_analytics'
    union all
    select
      'olist_data' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'olist_analytics'
    union all
    select
      'olist_data' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'olist_analytics'
  
[0m20:45:07.576490 [debug] [ThreadPool]: SQL status: SELECT 14 in 0.007 seconds
[0m20:45:07.577264 [debug] [ThreadPool]: On list_olist_data_olist_analytics: ROLLBACK
[0m20:45:07.577599 [debug] [ThreadPool]: On list_olist_data_olist_analytics: Close
[0m20:45:07.580769 [debug] [MainThread]: Using postgres connection "master"
[0m20:45:07.580956 [debug] [MainThread]: On master: BEGIN
[0m20:45:07.581100 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:45:07.591425 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m20:45:07.591587 [debug] [MainThread]: Using postgres connection "master"
[0m20:45:07.591804 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0b3", "profile_name": "temp_olist_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:45:07.605794 [debug] [MainThread]: SQL status: SELECT 5 in 0.014 seconds
[0m20:45:07.607018 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd061a3b5-ce59-41cd-b730-d4792e925daf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ecb590>]}
[0m20:45:07.607272 [debug] [MainThread]: On master: ROLLBACK
[0m20:45:07.607593 [debug] [MainThread]: On master: Close
[0m20:45:07.609071 [debug] [Thread-1 (]: Began running node model.temp_olist_project.stg_customers
[0m20:45:07.609284 [debug] [Thread-2 (]: Began running node model.temp_olist_project.stg_orders
[0m20:45:07.609661 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_olist_data_olist_analytics, now model.temp_olist_project.stg_customers)
[0m20:45:07.609942 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.temp_olist_project.stg_orders'
[0m20:45:07.610167 [debug] [Thread-1 (]: Began compiling node model.temp_olist_project.stg_customers
[0m20:45:07.610365 [debug] [Thread-2 (]: Began compiling node model.temp_olist_project.stg_orders
[0m20:45:07.614733 [debug] [Thread-1 (]: Writing injected SQL for node "model.temp_olist_project.stg_customers"
[0m20:45:07.616773 [debug] [Thread-2 (]: Writing injected SQL for node "model.temp_olist_project.stg_orders"
[0m20:45:07.617251 [debug] [Thread-2 (]: Began executing node model.temp_olist_project.stg_orders
[0m20:45:07.617625 [debug] [Thread-2 (]: Finished running node model.temp_olist_project.stg_orders
[0m20:45:07.617810 [debug] [Thread-1 (]: Began executing node model.temp_olist_project.stg_customers
[0m20:45:07.618188 [debug] [Thread-1 (]: Finished running node model.temp_olist_project.stg_customers
[0m20:45:07.618482 [debug] [Thread-1 (]: Began running node test.temp_olist_project.accepted_values_stg_orders_order_status__delivered__shipped__canceled__processing.73dfa1caf6
[0m20:45:07.618698 [debug] [Thread-4 (]: Began running node test.temp_olist_project.not_null_stg_orders_order_id.81cfe2fe64
[0m20:45:07.618928 [debug] [Thread-3 (]: Began running node test.temp_olist_project.unique_stg_orders_order_id.e3b841c71a
[0m20:45:07.619112 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.temp_olist_project.stg_customers, now test.temp_olist_project.accepted_values_stg_orders_order_status__delivered__shipped__canceled__processing.73dfa1caf6)
[0m20:45:07.619276 [debug] [Thread-2 (]: Began running node model.temp_olist_project.customer_metrics
[0m20:45:07.619496 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.temp_olist_project.not_null_stg_orders_order_id.81cfe2fe64'
[0m20:45:07.619706 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.temp_olist_project.unique_stg_orders_order_id.e3b841c71a'
[0m20:45:07.619879 [debug] [Thread-1 (]: Began compiling node test.temp_olist_project.accepted_values_stg_orders_order_status__delivered__shipped__canceled__processing.73dfa1caf6
[0m20:45:07.620058 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.temp_olist_project.stg_orders, now model.temp_olist_project.customer_metrics)
[0m20:45:07.620223 [debug] [Thread-4 (]: Began compiling node test.temp_olist_project.not_null_stg_orders_order_id.81cfe2fe64
[0m20:45:07.620381 [debug] [Thread-3 (]: Began compiling node test.temp_olist_project.unique_stg_orders_order_id.e3b841c71a
[0m20:45:07.626985 [debug] [Thread-1 (]: Writing injected SQL for node "test.temp_olist_project.accepted_values_stg_orders_order_status__delivered__shipped__canceled__processing.73dfa1caf6"
[0m20:45:07.627192 [debug] [Thread-2 (]: Began compiling node model.temp_olist_project.customer_metrics
[0m20:45:07.631401 [debug] [Thread-4 (]: Writing injected SQL for node "test.temp_olist_project.not_null_stg_orders_order_id.81cfe2fe64"
[0m20:45:07.634336 [debug] [Thread-3 (]: Writing injected SQL for node "test.temp_olist_project.unique_stg_orders_order_id.e3b841c71a"
[0m20:45:07.636056 [debug] [Thread-2 (]: Writing injected SQL for node "model.temp_olist_project.customer_metrics"
[0m20:45:07.636466 [debug] [Thread-1 (]: Began executing node test.temp_olist_project.accepted_values_stg_orders_order_status__delivered__shipped__canceled__processing.73dfa1caf6
[0m20:45:07.636640 [debug] [Thread-4 (]: Began executing node test.temp_olist_project.not_null_stg_orders_order_id.81cfe2fe64
[0m20:45:07.636849 [debug] [Thread-3 (]: Began executing node test.temp_olist_project.unique_stg_orders_order_id.e3b841c71a
[0m20:45:07.637174 [debug] [Thread-1 (]: Finished running node test.temp_olist_project.accepted_values_stg_orders_order_status__delivered__shipped__canceled__processing.73dfa1caf6
[0m20:45:07.637327 [debug] [Thread-2 (]: Began executing node model.temp_olist_project.customer_metrics
[0m20:45:07.637618 [debug] [Thread-4 (]: Finished running node test.temp_olist_project.not_null_stg_orders_order_id.81cfe2fe64
[0m20:45:07.637923 [debug] [Thread-3 (]: Finished running node test.temp_olist_project.unique_stg_orders_order_id.e3b841c71a
[0m20:45:07.638260 [debug] [Thread-2 (]: Finished running node model.temp_olist_project.customer_metrics
[0m20:45:07.638833 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:45:07.638975 [debug] [MainThread]: Connection 'test.temp_olist_project.accepted_values_stg_orders_order_status__delivered__shipped__canceled__processing.73dfa1caf6' was properly closed.
[0m20:45:07.639099 [debug] [MainThread]: Connection 'model.temp_olist_project.customer_metrics' was properly closed.
[0m20:45:07.639213 [debug] [MainThread]: Connection 'test.temp_olist_project.not_null_stg_orders_order_id.81cfe2fe64' was properly closed.
[0m20:45:07.639324 [debug] [MainThread]: Connection 'test.temp_olist_project.unique_stg_orders_order_id.e3b841c71a' was properly closed.
[0m20:45:07.639823 [debug] [MainThread]: Command end result
[0m20:45:07.683010 [debug] [MainThread]: Acquiring new postgres connection 'generate_catalog'
[0m20:45:07.683216 [info ] [MainThread]: Building catalog
[0m20:45:07.687781 [debug] [ThreadPool]: Acquiring new postgres connection 'olist_data.information_schema'
[0m20:45:07.691344 [debug] [ThreadPool]: Using postgres connection "olist_data.information_schema"
[0m20:45:07.691546 [debug] [ThreadPool]: On olist_data.information_schema: BEGIN
[0m20:45:07.691680 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:45:07.698652 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m20:45:07.698912 [debug] [ThreadPool]: Using postgres connection "olist_data.information_schema"
[0m20:45:07.699174 [debug] [ThreadPool]: On olist_data.information_schema: /* {"app": "dbt", "dbt_version": "1.9.0b3", "profile_name": "temp_olist_project", "target_name": "dev", "connection_name": "olist_data.information_schema"} */

    
    

    select
        'olist_data' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            when 'm' then 'MATERIALIZED VIEW'
            else 'BASE TABLE'
        end as table_type,
        tbl_desc.description as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        col_desc.description as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid
    left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
    left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)
    where ((upper(sch.nspname) = upper('olist_analytics') and
           upper(tbl.relname) = upper('olist_order_reviews_dataset')) or (upper(sch.nspname) = upper('olist_analytics') and
           upper(tbl.relname) = upper('olist_marketing_qualified_leads_dataset')) or (upper(sch.nspname) = upper('olist_analytics') and
           upper(tbl.relname) = upper('olist_order_payments_dataset')) or (upper(sch.nspname) = upper('olist_analytics') and
           upper(tbl.relname) = upper('olist_sellers_dataset')) or (upper(sch.nspname) = upper('olist_analytics') and
           upper(tbl.relname) = upper('olist_geolocation_dataset')) or (upper(sch.nspname) = upper('olist_analytics') and
           upper(tbl.relname) = upper('olist_customers_dataset')) or (upper(sch.nspname) = upper('olist_analytics') and
           upper(tbl.relname) = upper('stg_orders')) or (upper(sch.nspname) = upper('olist_analytics') and
           upper(tbl.relname) = upper('olist_order_items_dataset')) or (upper(sch.nspname) = upper('olist_analytics') and
           upper(tbl.relname) = upper('olist_closed_deals_dataset')) or (upper(sch.nspname) = upper('olist_analytics') and
           upper(tbl.relname) = upper('olist_products_dataset')) or (upper(sch.nspname) = upper('olist_analytics') and
           upper(tbl.relname) = upper('olist_orders_dataset')) or (upper(sch.nspname) = upper('olist_analytics') and
           upper(tbl.relname) = upper('product_category_name_translation')) or (upper(sch.nspname) = upper('olist_analytics') and
           upper(tbl.relname) = upper('stg_customers')) or (upper(sch.nspname) = upper('olist_analytics') and
           upper(tbl.relname) = upper('customer_metrics')))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence in ('p', 'u') -- [p]ermanent table or [u]nlogged table. Exclude [t]emporary tables
      and tbl.relkind in ('r', 'v', 'f', 'p', 'm') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table, [m]aterialized view. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
[0m20:45:07.709969 [debug] [ThreadPool]: SQL status: SELECT 87 in 0.011 seconds
[0m20:45:07.713704 [debug] [ThreadPool]: On olist_data.information_schema: ROLLBACK
[0m20:45:07.714050 [debug] [ThreadPool]: On olist_data.information_schema: Close
[0m20:45:07.733150 [info ] [MainThread]: Catalog written to /Users/sushmitha/Documents/projects/olist_dbt_project/target/catalog.json
[0m20:45:07.734827 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": true, "command_wall_clock_time": 0.49144197, "process_user_time": 0.866166, "process_kernel_time": 0.172369, "process_mem_max_rss": "121094144", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m20:45:07.735169 [debug] [MainThread]: Command `dbt docs generate` succeeded at 20:45:07.735125 after 0.49 seconds
[0m20:45:07.735337 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m20:45:07.735472 [debug] [MainThread]: Connection 'olist_data.information_schema' was properly closed.
[0m20:45:07.735649 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061ea390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1055563d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1023e0950>]}
[0m20:45:07.735875 [debug] [MainThread]: Flushing usage events
[0m20:45:08.640023 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:45:32.971971 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1040f8310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1041620d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104162a90>]}


============================== 20:45:32.974212 | 1f717b55-5e70-40da-b04e-de5ff48011e6 ==============================
[0m20:45:32.974212 [info ] [MainThread]: Running with dbt=1.9.0-b3
[0m20:45:32.974542 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/sushmitha/Documents/projects/olist_dbt_project/logs', 'version_check': 'True', 'profiles_dir': '/Users/sushmitha/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt docs serve', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m20:45:33.046757 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1f717b55-5e70-40da-b04e-de5ff48011e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103f12dd0>]}
[0m20:45:33.070356 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1f717b55-5e70-40da-b04e-de5ff48011e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1021b9210>]}
[0m21:01:49.984682 [error] [MainThread]: Encountered an error:

[0m21:01:49.998007 [error] [MainThread]: Traceback (most recent call last):
  File "/Users/sushmitha/Documents/projects/olist_dbt_project/envolist/lib/python3.11/site-packages/dbt/cli/requires.py", line 153, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/sushmitha/Documents/projects/olist_dbt_project/envolist/lib/python3.11/site-packages/dbt/cli/requires.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/sushmitha/Documents/projects/olist_dbt_project/envolist/lib/python3.11/site-packages/dbt/cli/requires.py", line 235, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/sushmitha/Documents/projects/olist_dbt_project/envolist/lib/python3.11/site-packages/dbt/cli/requires.py", line 264, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/sushmitha/Documents/projects/olist_dbt_project/envolist/lib/python3.11/site-packages/dbt/cli/requires.py", line 311, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/sushmitha/Documents/projects/olist_dbt_project/envolist/lib/python3.11/site-packages/dbt/cli/main.py", line 301, in docs_serve
    results = task.run()
              ^^^^^^^^^^
  File "/Users/sushmitha/Documents/projects/olist_dbt_project/envolist/lib/python3.11/site-packages/dbt/task/docs/serve.py", line 29, in run
    httpd.serve_forever()
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/socketserver.py", line 233, in serve_forever
    ready = selector.select(poll_interval)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/selectors.py", line 415, in select
    fd_event_list = self._selector.poll(timeout)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt

[0m21:01:50.002198 [debug] [MainThread]: Resource report: {"command_name": "serve", "command_wall_clock_time": 977.0819, "process_user_time": 0.745653, "process_kernel_time": 0.186501, "process_mem_max_rss": "104251392", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m21:01:50.003452 [debug] [MainThread]: Command `dbt docs serve` failed at 21:01:50.003272 after 977.08 seconds
[0m21:01:50.004397 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1041629d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1040f8790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104144390>]}
[0m21:01:50.005094 [debug] [MainThread]: Flushing usage events
[0m21:01:51.297273 [debug] [MainThread]: An error was encountered while trying to flush usage events
